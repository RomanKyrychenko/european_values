---
title: 
author: 
abstract: | 
  #### Міністерство освіти і науки України 
  #### Київський національний університет імені Тараса Шевченка
  #### факультет соціології
  #### кафедра теорії й історії соціології
  
  \newline \newline \newline
  
  ## КВАЛІФІКАЦІЙНА РОБОТА
  
  \newline
  
  #### на тему: 
  
  \newline
  
  ## «Географічний розподіл соціальних цінностей у Європі: фактори та закономірності» 
  
  Спеціальність: 054 «Соціологія»
  
  Освітня програма «Соціологія»
  
  Освітній рівень: магістр
  
  Кваліфікація: магістр соціології
  
  __Виконавець:__ 
  
  Кириченко Роман Олександрович,
  
  студент магістратури

  
  __Науковий керівник:__
  
  Цимбал Тарас Володимирович,
  
  кандидат соціологічних наук, доцент
  
  Магістерська робота допущена до захисту рішенням *кафедри теорії й історії соціології*
  
  Протокол №_____ від «___» _________ 2019 р.
  
  Зав. кафедри   ___________________  проф.  Судаков В.І.
                       підпис                      
  
  #### Київ  2019

toc-title: "ЗМІСТ"
header-includes:
  - \usepackage[ukrainian]{babel}
  - \addto\captionsenglish{\renewcommand{\contentsname}%{Whatever}%}
  - \pagenumbering{gobble} 
  - \centerline{\includegraphics[height=2in]{youricon.png}}
  - \large{TITLE}
  - \pagenumbering{arabic} 
output: 
  word_document:
    reference_docx: example2.dotx
    toc: yes
    highlight: zenburn
bibliography: references.bib
csl: sage_harvard_edited.csl
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(drake)

#title: |
#  Географічний розподіл соціальних цінностей у Європі: фактори та закономірності
#  Geographical distribution of social values in Europe: factors and patterns
#
#author: Роман Кириченко
```

# Анотація

У даній роботі здійснюється аналіз основних факторів, які впливають на географічний розподіл цінностей у Європі. У першому розділі розкрито існуючий стан досліджень цінностей в соціології, а також здійснено опис підходу Шалома Шварца до вимірювання загальнолюдських цінностей, що використовується в Європейському соціальному дослідженні. У другому розділі розкрито вплив географічного сусідства на цінності жителів європейських регіонів, а також проаналізовано, чи стають вони більш схожими. Третій розділ присвячено аналізу впливу досвіду економічних спадів на цінності. У четвертому розділі розкрито вплив політичних факторів на цінності європейців.

**Ключові слова:** соціальні цінності, Європа, ЄСС, шкала Шварца

In this thesis, an analysis of the main factors that influence the geographical distribution of values in Europe. The first chapter reveals the current state of research of values in social sciences, as well as describes the Shalom Schwartz approach to the measurement of universal human values used in the European Social Survey. The second section reveals the influence of geographical neighborhood on the values of the inhabitants of European regions, and also analyzes whether they become more similar. The third section is devoted to the analysis of the influence of the experience of economic downturns on values. The fourth chapter reveals the impact of political factors on the values of Europeans.

**Keywords:** social values, Europe, ESS, Schwartz scale

# Вступ

**Актуальність.** Європейські країни після Другої світової війни здійснюють спробу взаємної інтеграції економічного, політичного і соціального полів. Одним із виявів цієї спроби є створення Європейського Союзу. Аргументами такого процесу були і спільні цінності, на яких стоять європейські держави. Зокрема часто акцентують увагу на спільному християнському корінні європейців та тисячолітній взаємодії європейських народів. Європа єднається відразу в багатьох просторах. Ми можемо впевнено говорити про інтеграцію в політико-правовій сфері, яку ми можемо побачити через уніфікацію європейського законодавства та через появу нових загальноєвропейських органів управління. Економічну інтегрованість також досить просто прослідкувати через обсяги обмінів між кордонами європейських держав [@Schwartz2012].

Найважче продемонструвати інтеграції в полі соціальному, зокрема в сфері особистих цінностей громадян. Невідомо, чи стираються ціннісні бар’єри між жителями різних європейських регіонів і чи вирішальним для них є громадянство. Не секрет, що ряд подій європейської історії ХІХ-ХХ століть призвів до формування міжрегіональних «ліній розлому». Найвідомішою такою лінією є так звана «залізна завіса», яка на майже 50 років розділила Європу на капіталістичний і соціалістичний табори. Також загальновідомими є відмінності у розвитку країн європейського Півдня (Португалія, Іспанія, Греція, Італія) з їх тривалою авторитарною історією та країнами Західної Європи, які відносно рано обрали демократичний шлях розвитку (Франція, Бельгія, Нідерланди, Швейцарія). Німеччина в свою чергу після повалення нацистського режиму взагалі була розділена як країна на дві частини [@bilsky].

Однак після епохи постійного протиборства та розділень з кінця 1980-х років у Європі набрали сили інтеграційні процеси і наразі 27 країн Європи об’єднані спільним економічним і політичним простором, а якщо враховувати спрощені візові та економічні процедури, асоційовані членства, то майже всі європейські країни наразі утворюють одну велику спільноту. Така єдність економічного, політичного та соціального просторів сприяє більш динамічному культурному обміну між населенням різних європейських країн, особливо сусідніх. Ми припускаємо, що це все разом сприяє формуванню схожих цінностей у жителів Європи. Ознаки цього очевидні навіть через наявність та поширення використання терміну «європейські цінності» [@dopira].

Наявність спільного ціннісного простору дозволить також нам відповісти на питання, чи існує європейська ідентичність, адже схожі погляди на життя є запорукою досягнення взаєморозуміння у європейців. Також дослідження існування тенденції до утворення спільного ціннісного поля в Європі може допомогти відповісти на питання, який вплив мають процеси інтеграції у політичній і економічній сферах на сферу соціальну. Дані Європейського соціального дослідження є чудовим матеріалом, за допомогою якого ми можемо відповісти на ці питання.

Механізми і фактори формування цінностей людини давно знаходяться у полі зору суспільствознавців. Самі ці фактори не можна назвати погано дослідженими. На підставі доступної літератури з теми факторів, які впливають на цінності людини, їх можна розділити умовно на дві частини: мікрочинники (сім'я, оточення) та макрочинники (політика держави, система освіти, економіка). При цьому індивіди можуть бути в рамках однакових макро і мікроумов, однак переживати дещо різні досвіди з ними, що в свою чергу спричиняє відмінності у цінностях. Ці умови можуть проявлятися у різних сферах життя людини, насамперед у сфері економіки та політики.

**Об'єкт** - соціальні цінності жителів Європи.

**Предмет** - географічні закономірності розподілу соціальних цінностей у Європі.

**Мета** цього дослідження полягає у виявленні географічних закономірностей розподілу соціальних цінностей у Європі.

**Завдання:**

1) проаналізувати основні підходи до вимірювання соціальних цінностей населення;
2) визначити вплив фактору геграфічного сусідства на соціальні цінності населення регіонів європейських держав;
3) встановити, чи стають регіони Європи більш схожими за соціальними цінностями населення; 
4) перевірити гіпотезу про зв'язок кількості років економічного зростання, які припали на життя респондента ЄСС та його цінностей;
5) виявити період найбільшої чутливості до економічних змін у респондентів ЄСС;
6) проаналізувати вплив політичних факторів на цінності респондентів ЄСС.

У магітерській роботі використовувались наступні **методи** аналізу соціологічних та статистичних даних:

- кореляційний аналіз (для аналізу наявності взаємозв'язку між змінними, присутній у другому та третьому розділах роботи);
- аналіз просторових (другий розділ, це головний метод виявлення впливу географічного сусідства на цінності жителів європейських регіонів) та часових автокореляцій (другий розділ, необхідний для усунення впливу часового тренду);
- однофакторний диспесійний аналіз (третій розділ, застосовується для аналізу впливу економіки на ціності);
- t тест Стьюдента для порівняння середніх значень (четвертий розділ, використовується для виялення значущості впливу політичних факторів на цінності індивідів);
- ієрархічний кластерний аналіз (другий розділ, з його допомогою ми встановлюємо основні географічні ціннісні кластери в Європі);
- градієнтний бустинг дерев прийняття рішень (четвертий розділ, використовується для визначення ступеню впливу політичних факторів на цінності індивідів).

Таким чином, ми можемо сформулювати три основні гіпотези нашої магістерської роботи: 

1) протягом 2002-2014 років цінності європейців стали більш схожими і національні кордони не відіграють вирішальної ролі в їх розподілі;
2) життя в роки економічного спаду впливає на схильність до певних цінностей;
3) життя в роки політичної нестабільності впливає на схильність до певних цінностей.

**Наукова новизна** роботи полягає в тому, що у ній розглядаються такі нові фактори формування цінностей як географічне сусідство, економічний та політичний досвід, пережитий громадянами європейських країн. Це значно розширює розуміння закономірностей та фактоів географічного розподілу цінностей у Європі.

```{r, echo=FALSE}
#**Огляд літератури**. Проблематика цінностей знаходилася в полі зору філософів та науковців ще до появи соціологів, зокрема у #працях І. Канта [@Kant_2006]. 
#
#Теоретико-методологічне обґрунтування поняття цінностей можна зустріти ще в античній класичній філософії, працях #Середньовіччя, у мислителів епохи Відродження, філософів Нового часу, а також у працях М. Бердяєва, Е. Фромма, В. Франкла. #Аксіологічний драматизм пронизує роздуми М. Вебера і Е. Дюркгейма, О. Шпенглера і К. Ясперса, К.-Г. Юнга і В. Дільтея, Т. #Парсонса і П. Сорокіна, М. Шелера і Ю. Габермаса. Поняття цінності як філософської категорії розробляли Г. Лотце, В. #Віндельбанд, Г. Ріккерт, Г. Мюнстерберг, О. Дробницький, І.Кант, А. Коршунов, а також сучасні філософи, соціологи, культурологи #– О. Панарін, В. Барулін, С. Анісімов, М. Каган, Л. Мікешин, Б. Орлов, В. Сагатовський, Л. Столович.
#
#Значний вклад у створення теорії цінностей внесли американські та західноєвропейські соціологи У.Томас, Ф.Знанецький, М. #Рокіч, А. Маслоу, П. Блау. Заслуговують на увагу праці сучасних вітчизняних та зарубіжних науковців, які досліджували феномен #цінності та ціннісних орієнтацій, зокрема М.Алексєєвої, І.Бичка, Г. Головних, П.Гнатенка, В. Табачковського, В.Шубіна, В.Ядова #та ін. Проблема цінностей була предметом дослідження низки виконаних в Україні дисертаційних досліджень: К.Гайдукевич, Н. #Костенко, А. Кавалерова, Є. Подольської, О.Плахотнюк та ін.

#Науковий підхід до цінностей акцентує увагу на тлумаченні стандартів, взірців, еталонів, норм соціальної поведінки, як об’єктів мотивації та орієнтації суб’єкта діяльності. Це проблемне поле представлено дослідженнями В. Асмолова, В. Бакірова, В. Водзінської, Б. Додонова, Ю. Жукова, О. Зотової, І. Істоміна, І. Суріна, М. Лапіна, В. Оссовського, Є. Подольської, І. Попової, А. Ручки, Н. Побєди, О.Семашка, Л. Сокурянської, Л.Юлдашева тощо.
```

**Структура наукової роботи.** Наукова робота містить __ сторінок та складається зі Вступу, 4 розділів, Висновків, Списку використаних джерел та __ додатків.

**Технічні особливості роботи:** усі розрахунки виконано в середовищі R, версії 3.5.2 (2018-12-20). Інші технічні деталі див. Додаток 1-2.

# Розділ І. Теоретико-методологічні засади дослідження соціальних цінностей

## 1.1. Соціальні цінності: визначення та операціоналізація

Соціальні цінності визначають як ідеали, які керують або обмежують особисту поведінку індивіда, взаємодію з іншими індивідами [@BRAITHWAITE_1998]. Толкот Парсонс трактує соціальні цінності як «загальноприйняті уявлення про бажаний тип соціальної системи». В теорії Парсонса соціальні цінності походять від культури.

Цінності не є новим напрямком соціологічних досліджень. Так, вони займали вагоме місце ще в теоріях класиків соціології Вебера та Дюркшайма, де вони були елементом пояснення соціальної організації та змін. Класична праця Вебера "Протестантська етика та дух капіталізму" є по суті першою соціологічною спробою показати, як різні цінності, зумовлені релігією, впливають на економічні процеси та господарську активність населення. При цьому поле досліджень цінностей не обмежується соціологією: цінності вивчаються і у психології (тут мова йде про індивідуальні цінності), антропології та інших суміжних із соціологією дисциплінах. 

Цінності є дуже важливими для пояснення культурних відмінностей, відмінностей у розвитку суспільства чи його окремих соціальних груп. При цьому цінності можуть бути як «двигуном» соціальних змін, так і їх результатом.

З 1990-х років дослідження цінностей знову актуалізувалось, що не дивно у зв'язку з глобалізаційними процесами, які все частіше змушують нас говорити про міжкультурні відмінності. У соціології у цей час з'являються нові теорії, покликані операціоналізувати поняття «соціальних цінностей». Тут у першу чергу йде мова про теорію базових людських цінностей Шалома Шварца.

Застосування конструктивного значення в суспільних науках протягом минулого століття зазнало відсутності узгодженої концепції базових цінностей, змісту і структури відносин між цими цінностями, а також надійних емпіричних методів їх вимірювання [@Hitlin_2004; @Rohan_2000]. Останні теоретичні та методологічні розробки [@Schwartz_1992] призвели до відродження досліджень цінностей.

Остання теорія стосується основних цінностей, які визнають люди у всіх культурах. Вона ідентифікує десять мотиваційно різних типів цінностей і визначає динамічні відносини між ними. Деякі цінності конфліктують один з одним (наприклад, доброзичливість і сила), тоді як інші - сумісність (наприклад, відповідність і безпека). «Структура» цінностей відноситься до цих відносин конфлікту і конгруентності між цінностями. Цінності структуруються подібним чином у різних культурних групах. Це говорить про те, що існує універсальна організація людських мотивацій. Хоча характер цінностей та їх структура можуть бути універсальними, індивіди та групи істотно відрізняються відносно важливості, яку вони приписують цінностям. Тобто індивідууми та групи мають різні ціннісні «пріоритети» або «ієрархії».

## 1.2. Концепція європейських цінностей

Якщо говорити про європейські цінності, то це більше, ніж просто теоретичний конструкт соціологів на позначення особливостей цінностей населення європейських держав. Це вже давно політичний термін, який широко згадується в політичному дискурсі. Цим поняттям часто апелюють політики проєвропейського спрямування. 

Європейські цінності - це одні з головних факторів інтеграції європейського суспільства, більшості мешканців Європи, які окреслюють та впорядковують навколишній світ та його сприйняття для нього, виражені через загальнолюдські принципи і норми життя держави, суспільства та окремої людини, та лежать в основі їхньо ідентичності [@amelchenko_2013, с. 2].

Саме завдяки поширенню поняття європейських цінностей та його значенню наразі Європа являє собою радше не географічний, а ціннісний простір, об’єднаний не стільки природними межами, скільки розділенням спільних демократичних та ліберальних цінностей та установ. Таким чином, приналежність до європейського простору в такому значенні може відриватися від традиційного географічного фактору та поширюватися на будь-яку частину світу, що розділяє ці самі цінності [@sakalo_2016, с. 106–107].

Так Україна робить саме ціннісний вибір, рухаючись в бік Європи: переоцінка нашої ціннісної моделі та її трансформація до європейської в тому числі включає і прийняття українцями загальноєвропейських цінностей таких як повага до та дотримання прав людини, верховенство права, рівність, демократія, толерантність і так далі [@stan_2017]. Зокрема, однією з європейських цінностей є громадянське суспільства, необхідне для становлення європейського простору будь-де, і зважаючи на те, що передусім носіями європейських цінностей в Україні спершу виступають активні громадянські діячі, люди, які виходили відстоювати свої права та майбутнє України, зокрема, і під час Революції гідності, таким чином проявляючи себе як частину такогогромадянського суспільства, Україна справді рухаєтсья у бік європейського ціннісного простору і рух цей має імпульс саме від населення нашої країни [@kozlovets_2008, с. 157].

Зародження європейських цінностей велика частина дослідників відносить до часів Просвітництва та Великої французької революції, яка стала результатом та наслідків мислення Просвітництва. Так, девізом Революції було «свобода, рівність, братерство», які і досі лежать в основі європейських цінностей. Саме ціннісний вимір виокремлюють і говорячи про інтеграційні процеси в Європі, адже серед інших факторів культурно-історична близьксіть народів Європи, спільний цивілізаційний розвиток, в процесі якого зароджувалися і поділялися європейцями певні ідеї, уможливили об’єднання Європи і її становлення такою, якою ми бачимо її сьогодні. поруч з вимогами до економічних та політичних систем країн-претендентів на членство у ЄС стоять також і ціннісні вимоги [@amelchenko_2013, с. 6]. Яскравим прикладом важливості саме поширення європейських цінностей заради підтримання безпеки в регіоні (підкреслимо, що тут цінності справі виступають потужним фактором безпеки) є політики сусідства Європейського Союзу, зокрема, з країнами Східної Європи та Північної Африки. При цьому самі цінності не є абстрактними, а чітко прописані в низці нормативних документів, наприклад, таких як Європейська конвенція про захист парв людини і основоположних свобод 1950 року, Рамкова конвенція про захист національних меншин 1995 року і так далі. Тобто вони є інституціно закріпленими.

У 2000 році було прийнято Хартію основних прав Європейського союзу, де серед цінностей ЄС зазначаються рівність, свобода, демократія, безпека, людська гідність, правова держава, правосуддя [@stan_2017]. Європейські цінності ставлять в центр уваги людську особистість, її захист та захист її прав і свобод, і що дуже важливо - гідності, що чітко окреслено і в Хартії. Саме громадянство Європейського Союзу покликано презентувати та захищати ці права і свободи, це теж потужний символ та інструмент, а відтак - цінність у собі [@amelchenko_2013, с. 23].

Проект Конституції Європейського Союзу 2003 року [@es_const_2003] виокремлює європейськими цінностями людську гідність, повагу до прав людини, демократію, свободу, рівність, верховенство права, плюралізм, толерантність, недискримінацію. У 2007 році було пирйнято Договір про Європейський Соз зі змінами та доповненнями [@es_act_1992]. Серед іншого увага акцентується і на вже згаданій важливій для ЄС повазі до людської гідності, прав та свобод, демократичного суспільства, громадянського суспільства, рівних прав і так далі. Тож бачимо, що об’єднана Європа - це свого роду механізм просування демократичних цінностей, в центрі яких - людина та її права [@piren_2015, с. 83].

Попри те, що за свою історію Європа пережила багато війн та конфліктів, що європейські країни мають суперечливі історії, їхні культурні та релігійні фони різняться, завдяки певній цивілізаційній єдності та важливою мірою її усвідомленню, вони були здатні об’єднатися заради просування того спільного, що їх таки об’єднувало: тих цінностей, обудованих навколо індивідуалізму, що зародилися ще в епоху Відродження і продовжили своє існування через Просвітництво аж до сучаності [@bulvinsky_2014, с. 108].

Таким чином, і українська інтеграція до європейських інститутів не в останню чергу вимагає і закріплення цих ціннісних блоків в українському суспільстві. І Європейський Союз визнає, що Україна має спільну історію та цінності з країнами ЄС (наприклад, у Резолюції щодо ситуації в Україні від 25 лютого 2010 р. [@ep_ukr_2010]), що є важливим маркером дял нас. В свою чергу Україна зобов’язалася дотримуватися європейських цінностей у своєму розвитку, претендуючи на членство у ЄС: в Угоді про асоціацію 2014 року [@assotiation_2004] зроблено окремий акцент саме на дотриманні європейських цінностей, серед них і згадані права і свободи людини, демократичні принципи, права меншин, повага до різноманітності, відданість принципам вільної ринкової екноміки.

## 1.3. Критика концепту цінностей в соціології

Хоч цінності часто стають предметом соціологічних досліджень, сама концепція цінностей неодноразово критикувалась.

В останні декілька років цінності як абстрактні уявлення втратили частину своєї легітимності серед тих, хто прагнув пояснити політичну поведінку індивідів через когнітивні процеси [@Sears_1986]. Саме цей абстрактний характер змушував сумніватися в тому, наскільки цінності справді легко переходять до поведінки людини [@Bauman_1993]. За деякими поглядами цінності розглядаються як соціальні ідеали, відокремлені від світу дій, інші вважають їх соціальною пропагандою, яку можна використовувати для виправдання певних дій [@Kristiansen_1994]. Скептики ставлять під сумнів важливість цінностей у порівнянні з іншими більш нагальними поняттями, такими як потреба, інтерес, ставлення та норма, коли метою є передбачити, що людина буде робити в конкретній ситуації [@Ajzen_1991; @Bandura_1986; @Downs_1957]. Такі суперечки навколо поняття абстрактності цінностей зробило їх непридатними для конкретної наукової оцінки, вони стали вважатися занадто віддаленими від реального світу, щоб бути цікавими, і занадто відкритими для численних інтерпретацій, коли йшлося про аналіз формування дій.

І хоча такі погляди мають право на існування, вони не зважають на потребу людини в певних конструктах, що мають значення як на рівні формування індивідуальної поведінки, так і на рівні інституційної діяльності. Цінності за визначенням дослідників [@Rokeach_1973], є принципами дії, що охоплюють абстрактні цілі в житті і способи поведінки, які індивід або колектив вважає кращими у визначених обставинах та ситуаціях. Значення ж як такі, є і мікро-, і макропоняттями. На мікрорівні особистої поведінки людини цінності мотивують як внутрішні прийняті зсередини стандарти, які узгоджують потреби людини з вимогами суспільного життя. Вони дозволяють окремим особам оцінювати їхні доступні варіанти дій. На макрорівні більш загальних спільних культурних практик цінності являють собою спільні усвідомлення, що наділяють смислами, порядком та злагодженістю суспільне життя. Без цінностей не може бути особистої безпеки і стабільності суспільної організації.  У демократичному суспільстві загальні цінності, такі як наприклад права людей, стримують дії, які уряди країн могли би вважати законними у досягненні своїх політичних цілей. Той факт, що  навіть в обмежених цінностями можливостях дій існує багато варіантів останніх, не зводить нанівець корисність цих обмежень. Універсальність робить їх більш довговічними [@BRAITHWAITE_1998], і закріплює їх глибоко в культурі так, що деякі варіанти поведінки стають взагалі немислимими.

## 1.4. Основні характеристики цінностей

Існують різні характеристики цінностей. Загалом їх можна згрупувати в 5 категорій:

Перша група характеристк описує цінності як переконання, що походять від афектів. Цінності стають очевидними тоді, коли їм починає щось загрожувати. Наприклад, якщо для людини є важливою цінність традиції, то вони починають активно відстоювати її тоді, коли цій цінності щось загрожує (форми відстоювання можуть бути різними і залежать від інших обставин). Якщо цю цінність відстоюно, то вони відчувають себе щасливими.

Друга група стверджує, що цінності пов'язані з цілями, які стимулюють певні дії. По суті вона ототожнює цінності із цілями, для досягнення яких у індивідів є велика мотивація.

Третя група характеристик звертає увагу на те, що цінності не залежать від конкретних ситуацій і середовища, що відрізняє їх від норм. Якщо людина, наприклад, є прихильницею порядку, то вона цю прихильність проявлятиме в усіх ситуаціях та в усіх середовищах.

Четверта група характеристик вказую на те, що цінності є такими собі стандартами, критеріями, на основі яких людина здійснює свої дії, вирішує, що є хорошим, а що - поганим. При цьому цей вплив часто є несвідомим.

П'ята характеристика полягає в тому, що цінності упорядковуються за важливістю відносно одне одного. В кожного індивіда існує своя система пріоритетів цінностей, яка визначає, дотриманню якої цінності надавати перевагу у тих ситуаціях, коли потрібно вчинити всупереч одній із них [@Schwartz_1992].

### 1.5. Шкала Шварца для вимірювання соціальних цінностей

Операціоналізація соціальних цінностей - складна справа і попри тривалий час досліджень цінностей довго не існувало універсальних шкал їх вимірювання. Сама поява таких шкал у великій мірі заслуга міжнаціональних порівняльних соціологічних досліджень, які без єдиної узгодженої шкали вимірювання цінностей просто б не мали сенсу. Мова йде в першу чергу про два таких дослідження - Європейське соціальне дослідження та Глобальне дослідження цінностей.

В ЄСС для характеристики персональних цінностей використовується шкала Шварца. Вона в своєму класичному вигляді включає в себе 10 компонентів:

1) **влада**

**Мета:** соціальний статус і престиж, контроль чи домінування над людьми і ресурсами. 

Цінність влади присутня в багатьох соціологічних теоріях. З точки зору функціоналізму вона виникає як наслідок диференціації статусів  (Parsons, 1951). За великим рахунком соціальні інститути в тому вигляді, в якому вони існували й існують зараз були б неможливими без прийняття й існування цінності влади. Тільки прийняття влади як цінності уможливлює появу і дотримання ієрархій у суспільствах. Щодо первісної причини появи цінності влади, то тут переважно дослідники сходяться на думці, що це наслідок перетворення індивідуальних потреб у контролі та домінуванні над іншими [@allport_1961].

2) **досягнення**

**Мета:** персональний успіх через діяльність, яка згідно з соціальними нормами оцінюється як компетентна. ї

Існування цієї цінності зумовлене тим, що в принципі діяльність компетентних фахівців необхідна для виживання суспільства і ціледосягнення. Стандарти такої діяльності глибоко закріпились у культурі, що виражається через існування культурних стандартів компетентності у різних сферах людської діяльності. Більше того, у суспільствах давно існують системи освіти, що забезпечують передачу компетентності між поколіннями, її вироблення.

3)	**гедонізм**

**Мета:** задоволення або чуттєве задоволення для себе.

Суть гедонізму полягає у задоволенні фізичних потреб і потреб, пов'язаних із ними. Найбільш детально гедонізм описаний у працях Зігмунда Фройда (зокрема він детально описує з точки зору своєї теорії причини тяги людини до задоволення) [@freud_1933]. Суспільство споживання винесло дискусії про гедонізм на новий рівень, адже саме ця цінність є однією із пояснювальних факторів його появи.

4)	**стимулювання**

**Мета:** пошук нових викликів у житті.

Походження цінності стимуляції дослідники вбачають у потребі організму до різноманітності і життєвої активності [@Berlyne_1960]. Особливо актуальною ця цінність стала в часи модерну, коли суспільства стали стрімко прогресувати, це не було б можливим без цінності стимуляції.

5)	**самостійність**

**Мета:** можливість самостійно думати і діяти.

Походження цінності самостійності дослідники вбачають у необхідності оганізму контролі, автономності і незалежності, можливості самовираження [@Bandura_1977].

6) **універсалізм**

**Мета:** рощуміння і терпимість до загальнолюдських потреб, а також схильність до емпатії та гармої з навколишнім середовищем. Поява цієї цінності дуже пов'язана з можливостями існування людьских суспільств. По суті ця цінність відповідає за безконфліктний розвиток. Приймати точку зору інших людей чи її просто розуміти дуже важливо для цього. Так само важливо розуміти значення впливу на навколишнє середовище. Цей вплив може призвести до нестачі ресурсів для виживання, тому в цьому сенсі можна сказати, що поява універсалізму є наслідком прагнення людей до виживання.

7) **доброзичливість**

**Мета:** покращення добробуту близьких людей, що належать до однієї з індивідом соціальної групи. Походження цінності доброзичливості дослідники вбачають у потребі до приналежності, зокрема в приналежності до сім'ї [@Maslow_1965]. Доброзичливість дуже необхідна для збереження таких груп та членів таких груп. На доброзичливості ґрунтується кооперація близьких людей.

8) **конформність**

**Мета:** утримання від дій, які можуть порушути існуючі соціальні норми чи завдати шкоди іншим людям.

Ця цінність необхідна для органічного соціального розвитку, вона перешкоджує руйнуванню існуючих соціальних порядків, забезпечує стабільність соціальних відносин та соціальних інститутів. Вона також сприяє самозбереженню та самовідтворенню соціальних систем.

9) **традиція**

**Мета:** прийняття існуючої культури.

Загалом цілі цієї цінності досить схожі на цінності конформності. Однак традийія відповідає не стільки за бездіяльне прийняття існуючого стану речей, стільки його відтворення через використання і передачу існуючих і сакціонованих групою практик, символів, ідей та переконань [@Durkheim_1912].

10) **безпека**

**Мета:** безпека, гармонія і стабільність суспільства, відносин і самого себе. 

Цінність безпеки викликана як індивідуальними, так і груповими інтересами. Вона забезпечує індивідуальне та групове виживання у соціумі [@Maslow_1965]. Складні форми соціального життя породили у суспільствах складну інфраструктуру підтримання безпеки індивідів.

У ЄСС ці цінності відображені в 23-х змінних. Існує окрема інструкція по узагальненню цих цінностей до 10 описаних вище. Її суть полягає в тому, що рахується по кожному респонденту середнє значення змінних, що відповідають певній цінності і віднімається середнє значення відповідей на всі питання, що відповідають усім цінностям. Це нормально, адже шкала в певній мірі дуальна, тобто одній цінності ми можемо протиставити іншу. І таким чином ми уникаємо ситуації, коли людина загалом відповідає, що всі характеристики на неї схожі, і через це виходить викривлення даних у дослідженні.

```{r, echo=FALSE}
#Навіть 10 цінностей Шварца можна розкласти на ще дрібніші цінності-мотивації. загалом можна виділити цілий ряд пар мотивацій:
#
#- влада і досягнення - соціальна перевага і повага;
#- досягнення андеонізму - егоцентричного задоволення;
#- гедонізм і стимуляція - прагнення афективного приємного збудження;
#- стимуляція і самонаправлення - внутрішньо інтересна і нвелеві і мастери;
#- самоврядування і універсалізм - обгрунтованість одного суспільного судження і комфортності різноманітність існування;
#- універсалізм і доброзичливість - посилення інших і трансцендентність егоїстичні інтереси;
#- доброзичливість і традиція - прихильність до одної групи;
#- доброзичливість і відповідність - нормативна поведінка, що сприяє підвищенню відносин;
#- відповідність і традиція - підпорядкування самого себе на користь соціально нав'язаного очікування;
#- традиції та безпека - збереження існуючих соціальних механізмів, які дають впевненість у житті;
#- відповідність і безпека - захист порядку і гармонії у відносинах;
#- безпека і влада - уникнення або подолання загроз шляхом контролю відносин і ресурсів.
```

Цю шкалу з 10 пунктів можна ще більше узагальнити до 4-х. Такий спосіб є науково обґрунтованим і описаним у документації ЄСС:

1)	Відкритість до змін (Openness to Change)
2)	Самоперевершення (Self-Trancendence)
3)	Збереження (Conservation)
4)	Самовдосконалення (Self-Enhancement) [@Schwartz2012]

Це два виміри цінностей, описані Шварцом. Його схема цінностей уможливлює протисатвлення цінностей між собою. Сама можливість протиставлення є зручними аналітичним інструментом, який дозволює досить просто порівнювати групи людей.

**Малюнок 1. Основні індивідуальні соціальні цінності за теорією Шалома Шварца**
![](values_scheme.png)

Як ми бачмо з Малюнку 1, за одними із вимірів спостерігається протиставлення цінностей «відкритості до змін» і «збереження». Цей вимір охоплює конфлікт між цінностями, які підкреслюють незалежність думки, дій, почуттів і готовності до змін (самоврядування, стимулювання) і цінностей, які підкреслюють порядок, самообмеження, збереження минулого і опору змінам (безпека, відповідності, традиції). 

Другий вимір показує конфлікт між цінностями «самоперевершення» та «самовдосконалення». Цей вимір охоплює конфлікт між цінностями, які підкреслюють турботу про добробут і інтереси інших (універсалізм, доброзичливість) і цінності, які підкреслюють прагнення до власних інтересів і відноснгоо успіху і домінування над іншими (влада, досягнення). Гедонізм має ознаки як і відкритості до змін, так і самовдосконалення.

## 1.6. Висновок до розділу І

Таким чином, проблематика цінностей досить давно знаходиться в полі зору соціологів, однак стандартизовані шкали вимірювання цінностей, за якими можна було б порівняти громадян різних країн з'явилися відносно недавно. При цьому найпопулярнішою є шкала Шалома Шварца, яка використовується в дослідженні ЄСС.

Ціності європейців -  цікаве поле для досліджень, оскільки це не просто теоретичний конструкт, що використовують науковці, а поняття, яке закріплене в юридичних документах. Масиви ЄСС - чудове джерело даних, яке дозволяє нам проаналізувати, як ці цінності змінюються і під дією яких факторів.

Використання шкали Шалома Шварца для досягнення мети нашої роботи викликане наступними причинами:

1) використання цієї шкали в доступних масивах даних ЄСС. Ця шкала є визнаним інструментом вимірювання цінностей, в її основі лежить універсальна теорія людських цінностей Шварца.
2) шкала Шварца легко зводить вимірювання цінностей до двох дихотомій. Для нашої роботи це досить зручно, оскільки ми не ставимо за мету здійснити опис цінностей європейців, а лише загалом продемонструвати, які фактори вплинули на географічний розподіл цінностей. Використання для цього лише двох пар цінностей дуже спрощує нам роботу.

Таке узагальнення є прийнятним для нашої аналітичної роботи, оскільки її головна мета показати саме наявність зв’язку, а не його суть. Тим паче ми не ставимо за мету характеризувати цінності європейців, а лише говорити про те, чи є стали вони більш схожими протягом часу.

# Розділ ІІ. Географічні закономірності розподілу цінностей в Європі

Метою цього дослідження було з’ясувати роль державних кордонів у динаміці розподілу цінностей європейських країн протягом 2002-2014. Нас цікавили у першу чергу відмінності у цінностях між країнами у розрізі їх часу інтеграції в ЄС, а також в розрізі поколінь (молодь, середній вік, старший вік). При цьому ми припускаємо, що молодше населення Європи є більш ціннісно єдиним, ніж старше. Також ми передбачаємо, що різні країни демонструватимуть різну динаміку інтеграції в європейський ціннісний простір.

## 2.1. Методологія вивчення характеристики гегографічного розподілу ціннностей у Європі

Відповідь на це питання можна отримати через показники просторової асоціації (Indicators of spatial association).

Просторова асоціація полягає в наяності кластерів у просторовому розташуванні даних змінної. Наприклад, це може бути наяність певного явища у тільки близьких на карті точках. Таким явищем може бути епідемія хвороби. Просторову асоціацію ми спостерігаємо в Україні, коли дивимось на результати виборів, адже у нас стабільно відтворюється підтримка проєвропейських сил в західних та центральних регіонах, тоді як на Сході та Півдні помітно більшу підтримку мають проросійські сили. І точки обох підтримок не розсіяні на карті випадково, вони всі концентруються одне біля одного.

Найвідомішим показником просторової асоціації є просторова автокореляція.
Автокореляцією називають кореляцію функції із самою собою з певним зміщенням. Таким зміщенням може бути простір. 
Суть просторової автокореляції полягає в коваріації властивостей у географічному просторі: характеристики в близьких місцях корелюють сильніше, ніж у віддалених. Звісно, як і кореляція, так і автокореляція не стверджують про каузальний зв’язок, а лише показують певну взаємозалежність. 

Варто зазначити, що аналіз просторових автокореляцій є популярним методом у економіці, зокрема в економічній географії, зокрема в Україні є ряд економічних досліджень з використанням цього методу [@berezka_2013;berezky_2016; @voznak_2009; @kalashnikova_2017]. Соціологічні дослідження з використанням просторової автокореляції та просторової авторегресії є в США. Зокрема такими методом Дж. Леендер досліджував природу соціального впливу [@Leenders_2002]. Просторова автокореляція також є чудовим методом для встановлення гегоафічної сегрегації соціальних груп, що продемонстрував у своєму дослідженні цього явища Річард Морріл з університету Вашингтона [@Morrill_1991]. Дослідники Paul R. Voss and David D. Long and Roger B. Hammer and Samantha Friedman використовували просторову авторегресію для вивчення закономірностей розподілу дитячої бідності у США [@Voss_2006].

Просторова автокореляція є двох типів – глобальна і локальна. У нашій статті мова йтиме про глобальну автокореляцію, адже процеси, які ми досліджуємо відбуваються на просторах цілого континенту.

Глобальна просторова автокорреляція є мірою загальної кластеризації даних [@Anselin_2010]. 

Мірою просторової автокореляції є І Морана, винайдена Патріком Альфредом Пірсом Мораном, автралійським математиком [@ArcGIS]. На початку 1950-х років зусиллями трьох дослідників - Морана, Гірі та Вітла було розроблена ряд показників гегоафічної автокореляції [@Fotheringham_2009].
Коефіцієнт просторової автокореляції Морана є розширенням кореліцї Пірсона для одновимірних рядів. Так, якщо r Пірсона для двох змінних однакової довжини (x та y) визначається як:

$$r = r_{xy} =\frac{\sum(x_i-\bar{x})(y_i-\bar{y})}
{\sqrt{\sum(x_i-\bar{x})^2}~\sqrt{\sum(y_i-\bar{y})^2}}$$

де $\bar{x}$ та $\bar{y}$ - середній значення відповідних змінних. Якщо ми вивчаємо певні ознаки, розподілені в географічному просторі, то логічно очікувати, що їх значення в близьких територіальних одиницях будуть, швидше за все, схожими, а у віддалених  - помітно відрізнятимуться. Щоб це виявляти у формулу вище потрібно додати вагові коефіцієнти, які б таку близькість чи віддаленість позначали, у найпростішому випадку ми можемо сусідні територіальні одиниці позначати одиницею, а ті, які не мають сусідства - нулем. Власне, у цьому полягає ключова відмінність формули просторової автокореляції (частка "авто" тут позачає те, що ми вивчаємо не зв'язок однієї ознаки з іншою, а зв'язок однієї і тої самої змінної зі зміщеним варіантом самої себе) від традийіної формули кореляції Пірсона -  у наявності вагових коефіцієнтів, які позначаються як $w_{ij}$.

Суть просторової автокореляції полягає в кореляції значень змінних в місцях, що мають сусіднє розташування у просторі. Moran's I визначають як:

${\displaystyle I={\frac {N}{\sum _{i}\sum _{j}w_{ij}}}{\frac {\sum _{i}\sum _{j}w_{ij}(X_{i}-{\bar {X}})(X_{j}-{\bar {X}})}{\sum _{i}(X_{i}-{\bar {X}})^{2}}}}$, де $N$ – кількість просторових одиниць (наприклад, міст, регіонів); $I \ j$ – індекси просторових одиниць; $X$ – значення змінної для просторової одиниці; $\bar{X}$ – середнє від $Х$; $w_{ij}$ – матриця просторових значень. [3]

Варто сказати, що індекс Морана є не єдиним, що використовується для обчислення автокореляції у просторі. Використовують також Geary's C для визначення автокореляції на невеликих відстання. Тому цей показник називаєть індексом локальної просторової автокореляції. Однак обчислення автокореляції – це був фінальний етап нашої роботи. Для цього необхидно було здійснити велику підготовчу роботу.

## 2.2. Техніки і процедури дослідження гегоафічного розподілу цінностей у Європі з використанням показників просторової автокореляції

Алгоритм роботи був наступним:

1.	Підготовка даних масивів 7-х хвиль ЄСС до роботи в R. За допомогою бібліотеки foreign масиви було імпортовано для подальшої статистичної обробки.
2.	Компонування змінних дослідження. Нас з усіх великих масивів цікавили змінні, що містили інформацію про особисті цінності, вік, країну та регіон респондентів. Однак змінні з цінностями необхідно було ще окремо вирахувати, оскільки вони визначалися через 2-3 питання. Плюс до цього 10 класичних цінностей Шварца для зручності роботи ми перетворили в 4-ри. 
3.	Обробка масивів. Оскільки дослідження у нас порівняльне, то для зручності потрібні змінні потрібно було поєднати в одну таблицю і далі вже працювати з нею. Для кожного масиву було пораховано значення 4-х узагальнених цінностей по кожному регіону, що містився у масиві. Далі 7-м отриманих масивів було поєднано в один за ознакою регіон. Таким чином, ми отримали робочу таблицю розміром, що містила поля регіонів та змінні цінностей по кожній хвилі дослідження.
4.	Щоб мати можливість визначити індекс автокореляції до існуючих змінних в таблиці необхідно було додати змінні географічних координат. Тут варто зауважити, що технічно можна було порахувати автокореляції цінностей двома способами. Перший спосіб полягає в розрахунку показника відштовхуючись від центрів регіонів (центроїдів). Цей спосіб легший у реалізації, дозволяє рахувати автокореляцію для усіх регіонів, однак може некоректно встановлювати факт сусідства (сусідство тут встановлюється не за фактом спільного кордону, а за критерієм близькості в евклідовому просторі (це теж не зовсім коректно) чи за принципом k найближчих сусідів, коли ми встановлюємо, скільки найближчих точок вважати сусідніми. Ми обрали спосіб більш коректний -  автокореляцію за полігонами, де сусідні регіони встановлювалися за фактом наявності спільного кордону. Такий спосіб також має свої обмеження, оскільки ми не можемо знайти жодного сусіда для регіону, який повністю знаходиться на острові, тому, коли рахувався індекс не було враховано при цьому вплив таких регіонів як Крит, Корсика, Сицілія та Сардинія. Однак таких регіонів небагато, щоб сильно спотворити висновки, та ми їх розглянули додатково через графічний аналіз.

5.	Перевірка гіпотези, що полягала в обрахуванні індексу автокореляції Морана.

Обчислити Індекс Морана в R можна в двох бібліотеках: у бібліотеці **apa** - автокореляцію за точками, а в бібліотеці **spdep** - автокореляцію за полігонами. Оскільки ми використовували другу бібліотеку також додатково було проведено роботу з уніфікації назв регіонів у різних хвилях ЄСС (через переіменування, адміністративні реформи та банальну зміну принципу розбивки країни на регіони організаторами ЄСС їх назви та величина у різних хвилях ЄСС в рамках однієї країни могли різнитися), аби дані різних хвиль узгоджувалися між собою.

Робочий масив формату **SpatialPolygonDataFrame** являє собою набір значнь координат меж регіонів та значень цінностей, які ми взяли із масивів ЄСС. Такий масив далі подавався на вхід в функцію розрахунку коефіцієнту автокореляції Морана. На виході ми отримували значення коефіцієнту та p-value. Останнє свідчить про те, чи можемо ми на основі спостережуваного значення робити висновок щодо гіпотези.

На практиці функція робить матриці точок з нулями і одиницями. Одиниця позначає наявність зв’язку одного регіону з іншим. Потім іде визначення наскільки ці сусіди за значенням змінної є сусідами в географічному просторі. Збіг цих сусідств і є просторовою автокореляцією.

При аналізі потрібно зважати ще і на те, що сам Європейський Союз та учасники дослідження постійно змінювалися. Далеко не всі країни брали участь у дослідженні постійно. Плюс до цього при опитуванні в різних країнах у різних хвилях дослідження використовувався інколи різний поділ регіонів. Тому бували ситуації, коли країна брала участь в дослідженні постійно, але регіони в масиві присутні були різними.

Ми виділили 5 груп країн:

1)	Всі країни, що брали участь в дослідженні хоч одного разу. Вона нам цікаві найбільше з тої точки зору, що через них ми можемо перевірити, наскільки впливає на показник зміна учасників опитування.
2)	Країни, що брали участь в дослідженні і були членами ЄС станом на 2002 рік.
3)	Країни, що брали участь в дослідженні і були членами ЄС станом на 2004 рік.
До попереднього масиву додалися Польща, Угорщина, Словенія, Словаччина, Чехія, Литва, Естонія, Латвія.
4)	Країни, що брали участь в дослідженні і були членами ЄС станом на 2007 рік.
До попереднього масиву додалася Болгарія та Румунія. 
5)	Країни, які брали участь в усіх хвилях дослідження. 

## 2.3. Географічні закономірності розподілу цінностей у Європі

### 2.3.1. Аналіз географічних закономірностей розподілу цінностей у Європі на всіх країнах, що доступні у масивах даних ЄСС

За аналізом динаміки автокореляції цінностей в усіх країнах Європи ми зафіксували загальну тенденцію до росту інтеграції європейських держав. Так, наприклад, якщо станом на 2002 рік автокореляція за цінністю відкритості до змін становила 0.67, то уже в 2016 році цей показник зріс до 0.78. За іншими цінностями ми також бачимо ріст автокореляції. Цінність відкитості до змін наразі в європейських країнах проявляється найбільш схоже.

**Таблиця 1. Динаміка автокореляції цінностей **
```{r, echo=FALSE}
loadd(tendenz)
tendenz %>% 
  dplyr::select(round, estimate1, value) %>% 
  tidyr::spread("value", "estimate1") %>% 
  flextable::flextable() %>% 
  flextable::autofit(add_w = 0.1, add_h = 0.1)
```

З малюнку 1 видно, що тенденція до росту показника автокореляції не є лінійною, зокрема під час 4-6 хвиль було навіть зафіксовано його зниження. Це пов'язано (як й інші коливання) з тим, що саме тоді до дослідження долучилось багато країн Східної Європи, у тому числі Росія. Проте після цього автокореляція виросла. Тут ми не можемо однозначно сказати, чи не був викликаний ріст показників саме збільшенням інтеграції, тому додатково проаналізували автокореляцію за поколіннями.

**Малюнок 2. Значення індексу Морана за хвилями ЄСС у розрізі 4-х цінностей**
```{r q_plot , fig.width = 7, fig.height=4, message=FALSE, echo=FALSE}
loadd(tendenz_lines)
tendenz_lines
```

Як виявилось, покоління різні покоління європейців демонструють різну ступінь спорідненості. Так, молодь (до 35 років) та представники середнього віку (35-60 років) значно інтегрованіші в загальноєвропейський простір, ніж старше покоління (60+ років). Особливо сильні відмінності за цінностями консерватизму та самотрансцендентності, що можна побачити з таблиці 2.

**Таблиця 2. Просторова автокореляція цінностей для вікових груп**
```{r, echo=FALSE}
loadd(ages) 
ages %>% flextable::flextable() #%>% flextable::autofit(add_w = 0.1, add_h = 0.1)
```

Показники автокореляції все ж є загальною характеристикою уніфікованості простору, однак, якщо ми хочемо охарактеризувати основні закономірності розподілу цінностей, то маємо потребу звернутися до графічного аналізу.

**Малюнок 3. Карта розподілу цінностей у просторі**
```{r map , fig.width = 7, fig.height=4, message=FALSE, echo=FALSE,warning=FALSE,message=FALSE}
loadd(values_distribution_plot)
values_distribution_plot
```

Так, з карти ми можемо побачити, що ціннісні кордони в Європі розподілені нерівномірно. Наприклад, можна стверджувати, що жителі Франції, Німеччини, Данії, Австрії, Швеції та країн Бенілюксу мають загалом досить схожі цінності (на карті ми не бачимо чіткого кордону між їх сусідніми регіонами). При цьому від них досить сильно відрізняються іспанці, поляки, чехи та італійці, де цінності сусідніх з іншими країнами регіонів помітно відрізняються і ми можемо чітко за кольором побачити меді цих країн. З країн Східної Європи помітно вирізняється Угорщина, яка ціннісно ближча до Захіної Європи, ніж до своїх сусідів. Цікавою є наявність відмінностей між країнами Скандинавії, особливо сильно помітні відмінності між Швецією та Норвегією, яка є історично близькою, але не входитьв Європейський Союз (шведи більш консервативні).

**Малюнок 4. Деталізована карта розподілу цінностей (10 основних цінностей з теорії Шварца) у просторі**

![](values_choropleth.png)

Ця нерівномірність проявляється також, якщо порахувати окремо коефіцієнт автокореляції Морана для груп країн в залежності від дати їх вступу в ЄС (рахувався показник цінностей усереднений за роки участі для кожного регіону). Так, з Таблиці 3 видно, що чим пізніше група країн була інтегрована, тим менш вона ціннісно схожа на інші країни ЄС. Особливо сильно це помітно за цінністю самовдосконалення, тоді як за цінністю збереження цей зв'язок проявляється не так сильно. 
**Таблиця 3. Автокореляція цінностей за групами країн**
```{r, echo=FALSE}
loadd(country_groups)
country_groups %>% flextable::flextable() #%>% flextable::autofit(add_w = 0.1, add_h = 0.1)
```

### 2.3.2. Аналіз географічних закономірностей розподілу цінностей у Європі на країнах постійних учасниках ЄСС

Для більш точної оцінки тенденцій ми також окремо розглянули ті країни, які брали участь в усіх 8-ми хвилях ЄСС. Це Німеччина, Бельгія, Нідерланди, Франція, Фінляндія, Угорщина, Ірландія, Норвегія, Польща, Португалія, Словенія, Швеція, Іспанія, Швейцарія та Велика Британія.

З таблиці нижче видно, що тенденція до інтеграції наявна, хоч наявні деякі коливання показників в окремі роки. Тут не варто забувати, що соціальний контекст також може впливати на актуалізацію тих чи інших цінностей.  Особливо, якщо цей контекст притаманний тільки одній із країн, що потенційно може викликати розбіжності, які позначаються на коефіцієнті просторової автокореляції.

**Таблиця 4. Динаміка автокореляції цінностей в країнах-постійних учасниках ЄСС**
```{r, echo=FALSE}
loadd(tendenz_all_table) 
tendenz_all_table %>% flextable::flextable() #%>% flextable::autofit(add_w = 0.1, add_h = 0.1)
```

### 2.3.3. Кластерний аналіз цінностей європейських регіонів

Також на основі даних було проведено кластерний аналіз регіонів за цінностями.

Щоб підтвердити ці здогади, ми зробимо і візуалізуємо кластерний аналіз цих даних. Не забувайте, що у нас є фактор кластеризації не тільки цінностей, але і гео-спорідненості регіонів. Отже, більшість алгоритмів кластеризації, таких як k-середні, мають частково випадковий принцип формування кластера. Нам потрібна модель в групуванні кластерів, спочатку вибираємо географічно близькі одиниці. Тому для нас не підходить звичайний підхід до кластеризації; необхідний варіант, який враховує гегауфію. І цей варіант існує.

Я використовував пакет **ClustGeo** для кластеризації даних просторового конструктиву.

Метод, реалізований у цій бібліотеці, - це адаптація ієрархічного кластерного аналізу для завдання групування геоприв'язних даних. Це сукупність двох ієрархічних моделей, один з яких базується на даних, а інший - на аналізі географічного сусідства.

**Малюнок 5. Дендрограма за результатами кластеризації європейських регіонів на основі змінних цінностей**
```{r, echo=FALSE, fig.width = 7, fig.height=10, dpi=300}
loadd(clusters_plot, cluster_decision, dendrogram)
dendrogram
```

З побудованої дендрограми зрозуміло, що два великих кластери чітко розділяються на кілька дрібніших кластерів. Ми визначимо два пороги для виділення цих двох кластерів та їх деталізацію ще на 2-3 кластери. Оптимальними значеннями для порогів є 0.01 і 0.005.

Пакет **ClustGeo** також має можливість визначити ідеальне співвідношення між ієрархічними моделями кластерного аналізу. Цього можна досягти за допомогою функції вибору альфа, яка дасть оптимальне значення альфа (наведені вище моделі вже базуються на цьому співвідношенні). Ми не просто розраховуємо, а візуалізуємо:

**Малюнок 6. Графік оптимального значення параметру alpha для кластеризації**
```{r, echo=FALSE, fig.width = 7, fig.height=8, dpi=300}
cluster_decision
```

Після цього ми просто повинні помістити дані кластеризації на карту.

**Малюнок 7. Карта європейських ціннісних кластерів на основі даних ЄСС**
```{r, echo=FALSE, fig.width = 7, fig.height=8, dpi=300}
clusters_plot
```

Як бачимо, підтверджується наше припущення про відмінності між Заходом і Сходом. Хоча є цікаві нюанси. Наприклад, Італія виявилася ближчою до Східної Європи, ніж до Заходу. Цікаво також віднести Естонію до західноєвропейського кластеру.

## 2.4. Висновок до розділу ІІ

Таким чином, ми можемо стверджувати про наявність тенденції до формування загальноєвропейського ціннісного простору. Ця тенденція проявилася через збільшення автокореляції цінностей країн Європи протягом хвиль ЄСС. На прикладі країн-постійних учасниць дослідження також видно, що цей ріст не є наслідком участі чи не участі певних держав у дослідженні. Також про наявність тенденції свідчить більший показник автокореляції цінностей у молоді та людей середнього віку. Національні ціннісні кордони більш помітні, якщо брати до уваги тільки людей старшого віку (60+). Національні кордони все ще мають велике значення, однак у Західній Європі уже досить складно провести чіткі внутрішні ціннісні кордони. Також можна стверджувати, що так звана "залізна завіса" слабко пояснює ціннісні відмінності. Так, якщо між Польщею та Німеччиною є помітні відмінності, то ось такі країни як Естонія, Угорщина, Словенія ціннісно більш схожі до країн Західної Європи, навіть більш схожі, ніж "старожили" Європейського Союзу Іспанія та Італія, які серед них найбільше вирізняються.

З проведеного дослідження ми не можемо стверджувати про те, що єдиний європейський ціннісний простір буде сформовано у найближчому майбутньому, оскільки не можна виключати поширення відцентрових тенденцій, які уже помітні на політичному та економічному рівні (Брексит, уряди євроскептиків в Італії та Угорщині), однак на даний момент ми зафіксували чіткі ознаки наявності процесу формування такого простору.

Також зауважимо, що обраний метод дослідження (коефіцієнт автокореляції Морана) мав деякі обмеження, через які ми  можемо робити тільки генералізовані висновки. Значення індексу Морана могло також сильно коливатися від географічних особливостей регіонів, у яких проводилося ЄСС, та розмірів вибірок, які там робилися (маленький за роззміром регіон має зазвичай маленький розмір вибірки).При цьому неучасть однієї з країн у хвилі могла зробити дуже сильний перекіс для індексу, так само, як і зміна переліку регіонів, що беруть участь у дослідженні.

# РОЗДІЛ ІІІ. Економічні закономірності розподілу цінностей в Європі

## 3.1. Економіка та цінності у світлі соціологічних досліджень 

Якщо питання впливу сім'ї, оточеня досить добре досліджені в плані їх впливу на цінності людини, то роль макроекономічних чинників - менше. Тут зробимо уточнення: під макроекономічними чинниками ми розуміємо динаміку і стан економічного розвитку всього суспільства, а не особистості чи окремої сім'ї. У цій аналітичній роботі ми перевіримо гіпотези, присвячені впливу пережитого макроекономічного досвіду на цінності індивіда. Тобто з одного боку ми проаналізуємо те, як впливає економічний розвиток суспільства на цінності індивідів, з іншого боку - персональний досвід індивіда, оскільки при аналізі враховуватиметься період життя кожного опитаного респондента.

Додатково ми перевіримо, в які періоди життя цінності індивіда найбільше піддаються зовнішньому впливу. На думку більшості дослідників, зокрема, Інглехарта - це період студентських років 18-25 [@azuan], однак ми підозрюємо, що в різних суспільств цей час може різнитися.

В основі нашої аналітичної роботи лежать наступні гіпотези.

**Гіпотеза-підстава 1:** існує зв'язок між роками економічного зростання, що припадають на життя індивіда та його цінностями.

**Гіпотеза-наслідок 1.1:** чим більше на життя індивіда припало років економічного спаду, тим він консервативніше у своїх поглядах.

**Гіпотеза-наслідок 1.2:** чим більше на життя індивіда припало років економічного спаду, тим більше він орієнтований на самовдосконалення.

**Гіпотеза-підстава 2:** вирішальними для цінностей індивіда є роки його юності.

**Гіпотеза-наслідок 2.1:** найбільший зв'язок між цінностями та економічним ростом країни респондента у період 14-18 років.

**Гіпотеза-наслідок 2.2:** після 40 років економічний добробут країни проживання індивіда та його цінності не мають зв'язку.

## 3.2. Дані економічного розвитку європейських держав

### 3.2.1. Проект Медісона з історичної реконструкції ВВП за паритетом купівельної спроможності

Для перевірки гіпотези ми обрали дані усіх нині наявних на сайті ЄСС масивів 8-ми хвиль дослідження та масиву з історичними розрахунками ВВП за паритетом купівельної спроможності для різних країн [@Maddison2018]. 

Варто зауважити, що для дослідження динаміки економічного розвитку країн Європи ми мали декілька альтернативних масивів даних, однак обрали масив Maddison Historical Statistics Project, що збирає та розміщує Groningen Growth and Development Centre at the University of Groningen. Вибір цього масиву зумовлений наступними причинами:

- повнотою даних: для більшості країн є розрахунки ВВП починаючи з 1900 року, що хоплює тривалість життя всіх респондентів (наприклад, дані Світового банку охоплюють лише період з 1960 року і до сьогодні);
- розрахунком за паритетом купівельної спроможності: такий розрахунок більш чітко відтворює те, наскільки економічні зміни відчуло населення країн.

Робота з усіма масивами ЄСС зумовлена тим, що нас не цікавлять окремі держави чи роки проведення дослідження. Мета нашої аналітичної роботи встановити, чи взагалі економічний добробут впливає на цінності людини.

### 3.2.2. Фільтрація даних

При цьому ми відсіяли окремі країни із загального масиву даних за двома критеріями: наявності повних історичних даних про ВВП та розміром країни. Якщо відсутність даних про ВВП банально унеможливлювало перевірку поставлених гіпотез, то менші країни ми відсіяли через потенційно великий вплив глобальних економічних трендів на них та потенціно високу частку мігрантів серед них (наприклад, нам важко робити висновки щодо Ізраїлю, коли велика частина населення (за даними ЄСС - 33%) пережила частково досвід економіки інших країн). Таким чином, у фінальному масиві ми залишили тільки респондентів з Австрії, Бельгії, Швейцарії, Чехії, Німеччини, Данії, Іспанії, Фінляндії, Франції, Великобританії, Греції, Угорщини, Ірландії, Італії, Нідерландів, Норвегії, Польщі, Португалії, Швеції, Словенії, Естонії, Ісландії, Словаччини, Туреччини, України, Болгарії, Росії, Хорватії, Латвії, Румунії, Литви та Албанії (змінна *cntry*).

При цьому для чистоти аналізу цей масив було також відфільтровано на основі змінної *brncntr*, що фіксує факт народження респондента у тій же країні, де його і опитали. Частка таких осіб у різних країнах коливається: від 99,4% в Румунії до 78,3% в Швейцарії.

Подальша фільтрація масиву вже відбувалася на підставі відсутності відповідей на питання, за допомогою яких ми перевіряли гіпотези. Після операцій фільтрування у нас в масиві залишилось загалом 287 836 спостережень за 8 хвиль дослідження у 32 країнах Європи.

### 3.2.3. Створення додаткових змінних

Опис принципу створення 4-рьох змінних, які узагальнено відтворюють цінності європейців, міситься у Першому розділі роботи.

Наступним кроком після створення цих змінних було визначення, скільки років зростання економіки припало на життя кожного респондента в масиві. Це ми визначили за допомогою наступних кроків:

- визначили, який проміжок часу нас цікавить у випадку кожного окремого респондента нас цікавить (від року народження до року проведення опитування);
- у масиві з даними про ВВП країн за паритетом купіівельної спроможності визначили для кожної країни темпи приросту починаючи з 1900 року;
- за змінними країни та років поєднали два масиви і отримали змінну, в якій було зафіксовано темпи приросту ВВП в усі роки життя респондента до моменту опитування (технічно дані зберігалися у форматі *list*);
- зробили на основі створеної змінної ще одну змінну, де зафіксували частку років життя респондента, коли економіка його країни мала приріст.

Саме останню змінну ми далі використовуємо для перевірки гіпотез. Змінна з показниками приросту протягом кожного року життя респондента була залишена для можливості у ході аналізу порахувати додаткові змінні, наприклад, середній темп росту протягом життя чи в певний період життя тощо.

Приріст ВВП рахувався наступним чином:

$$Приріст = \frac{ВВП\ минулого\ року}{ВВП\ поточного\ року}$$
Отже, ми створили в масиві необхідні для перевірки гіпотез змінні.

## 3.3. Перевірка гіпотез щодо впливу економічного досвіду населення європейських держав на їх цінності

### 3.3.1. Усунення пливу трендів

Отримані дані мають свою специфіку аналізу. Обчислені показники економічного досвіду респондентів є історично зумовленими. Ми маємо справу частково із **часовими рядами (time series)**. Часові ряди мають наступні особливості:

- односторонність зв'язку (щось може залежати від часу, але не час від чогось іншого);
- наявність факторів тренду, сезонності, шуму, які при аналізі варто усувати.

Для визначення об'єктивного впливу частки років економічного росту людини на її цінності, потрібно переконатися, що ті змінні, через які ми перевіряємо наші гіпотези не місять часових зміщень.

Найпростіший шлях - графічний аналіз для виявлення наявності лінійного тренду (чи циклічності) та розрахунок показників автокореляції. 

Для цінності консерватизму:

**Малюнок 8. Графік автокореляції цінності консерватизму**
```{r actocor, include=FALSE}
loadd(acf_conservation)
acf_conservation %>% plot()
```

Для економічного росту:

**Малюнок 9. Графік автокореляції економічного росту**
```{r autocor2, include=FALSE}
loadd(acf_growth)
acf_growth %>% plot()
```

З аналізу видно, що зв'язок між сусідніми роками дуже великий. Це спонукає нас перетворити змінні так, аби усунути лінійні тренди росту та падіння.

Є різні способи усування лінійних трендів із часових рядів. Це можна зробити на основі плаваючого середнього чи лінії лінійної регресії. При цьому далі в аналізі використовуватимуться саме залишки таких моделей. Модель з плаваючим середнім на практиці виявилася не дуже зручною, оскільки за умов її використання перші і останні значенння часового ряду отримують значення **NA** (банально для моделі не вистачає спостережень, за якими можна зробити лінію плаваючого середнього). 

За великим рахунком наш аналіз став аналізом залишиків моделі цінностей та частки економічного росту з часом.

### 3.3.2. Аналіз взаємозв'язку років економічного росту, які пережила людина і її цінностей

З кореляційного аналізу залишків показав, що взаємозв'язок між економічним ростом та цінностями слабкий. Це доволі прогнозовано, оскільки цінності детермінуються одночасно багатьма факторами, ми ж у своїй аналітичній роботі визначаємо, чи впливає економічний добробут суспільства в принципі хоч у малій мірі на цінності.

З аналізу видно, що найбільш чутливим до економічного росту та спадів є Туреччина, де значення кореляції частки років економічного росту та самовдосконалення дорівнює -0.238 при довірчих інтервалах (-0.275457504; -0.199931526), а кореляція між часткою років економічного росту та консерватизмом дорівнює 0.268 з довірчими інтервалами (0.249106319; 0.322610783). Те, що Туреччина найбільше вирізняється з-поміж країн Європи - це не виглядає дивно через її особливості культури. 

**Таблиця 5. Кореляція Пірсона між самовдосконаленням та економічним ростом за країнами**
```{r tbl con, echo=FALSE}
loadd(se_cor_df)
se_cor_df %>% flextable::flextable() #%>% flextable::autofit(add_w = 0.1, add_h = 0.1)
```

Як видно з таблиці позитивна кореляція більше 0.05 у таких країн, як Данія, Німеччина, Естонія, Ісландія, Нідерланди та Росія.

Негативна кореляція проявляється сильніше. Найбільша негативна кореляція у вже згаданої Туреччини, Албанії, Греції, Португалії, Румунії та Іспанії. Тобто країни Південної Європи відрізняються реакціями на економічний добробут від країн, розташованих північніше.

**Таблиця 6. Дисперсійний аналіз між самовдосконаленням та економічним ростом за країнами**
```{r tbl anova, echo=FALSE}
loadd(se_anova_df)
se_anova_df %>% flextable::flextable() #%>% flextable::autofit(add_w = 0.1, add_h = 0.1)
```

Кореляція з консерватизмом менша. Для великої частини країн вона взагалі відсутня.

**Таблиця 7. Кореляція Пірсона між консерватизмом та економічним ростом за країнами**
```{r tbl s, echo=FALSE}
loadd(co_cor_df)
co_cor_df %>% flextable::flextable() #%>% flextable::autofit(add_w = 0.1, add_h = 0.1)
```

У випадку консерватизму принцип відмінності між країними менш очевидний. Найбільша позитивна кореляція у Туреччини, Албанії, Португалії та Ісландії. Найбільша негативна кореляція у Австрії, Іспанії, Німеччини та Словаччини. Цікаво, що сусідні і культурно близькі Іспанії та Португалія опинилися на різних полюсах.

**Таблиця 8. Дисперсійний аналіз між консерватизмом та економічним ростом за країнами**
```{r tbl anova s, echo=FALSE}
loadd(co_anova_df)
co_anova_df %>% flextable::flextable() #%>% flextable::autofit(add_w = 0.1, add_h = 0.1)
```

Таким чином, частка років життя за економічного росту має малий взаємозв'язок із цінностями. Однак ми припускаємо, що у різні періоди життя цей вплив можу бити різними, або, наприклад, з часом згладжуватися. Саме тому ми на цьому не зупинилися і вирішили перевірити гіпотези про різний час максимального впливу економіки на цінності.

Гіпотези 1.1 і 1.2 підтвердилися частково, оскільки у різних країн різне спрямування зв'язку між цінностями та часткою років економічного добробуту, що припадає на життя людини.

### 3.3.3. Виявлення часу найбільшої чутливості індивіда до економічних коливань

Визначення рівня впливу частки років економічного зростання, які припадають на життя індивіда у різних країнах, на його цінності замало для повної характеристики цього взаємозв'язку. Без сумніву, є такі періоди життя, коли цінності індивіда більш схильні змінюватися, а є і такі, що навіть затяжна економчіна криза не здатна змінити. Саме тому ми провели додатково аналіз, який допоміг нам визначити такі періоди життя в різних країнах. Так, згідно з нашою гіпотезою такі періоди в різних країнах будуть відмінними через культурні особливості, а також через асинхронність криз. За період життя наших респондентів лише одна криза торкнулася всіх країн - світова фінансова кризха 2008 року. Криза 1973 року не зачепила країни соцтабору, так само як криза 1990-х характерна тільки країнам посткомунізму. У різних країн були свої кризи, пов'язані з різними політичними процесами, особливостями розвитку. Отже, теоретично є всі умови для того, що період найбільшого впливу економіки на цінності в різних країнах буде відмінним.

Для цього ми взяли всіх респондентів старше 40 років (оскільки тільки в таких респондентів ми можемо побачити вплив різних періодів життя на цінності) та проаналізували, в які роки життя економічний розвиток впливав на цінності більше, ніж в інші. 

Роки найбільшої чутливості до економічних коливань за країнами (найбільший рівень кореляції):

Austria: (1, 2, 31, 34, 35)

Belgium: (3, 7, 8, 9, 10)

Switzerland: (3, 10, 11, 12, 13)

Germany: (32, 33, 34, 35, 36)

Denmark: (31, 32, 33, 34, 35)

Spain: (2, 3, 5, 6, 7)

Finland: (31, 32, 33, 34, 35)

France: (4, 5, 6, 34, 35)

United Kingdom: (39, 40, 41, 49, 50)

Greece: (4, 20, 21, 22, 27)

Hungary: (35, 36, 37, 38, 54)

Ireland: (15, 17, 18, 59, 60)

Netherlands: (31, 32, 34, 39, 60)

Norway: (4, 52, 53, 54, 55)

Poland: (17, 18, 19, 20, 21)

Portugal: (46, 47, 48, 49, 50)

Sweden: (1, 31, 33, 34, 35)

Slovenia: (51, 52, 53, 54, 55)

Iceland: (22, 43, 56, 57, 58)

Turkey: (3, 8, 37, 38, 39)

Bulgaria: (29, 30, 31, 32, 33)

Romania: (1, 3, 4, 44, 53)

Albania: (17, 18, 53, 54, 55)

Italy: (1, 57, 58, 59, 60)

Як бачимо, країни можна розділити на 4-ри групи:
1) найбільша чутливість в дитинистві (Бельгія, Іспанія, Франція, Румунія, Швейцарія)
2) найбільша чутливість в студентські роки (Греція, Польща)
3) найбільша чутливість у близько 30-40 років (Австрія, Німеччина, Данія, Фінляндія, Угорщина, Швеція, Болгарія, Туреччина)
4) найбільша чутливість після 40 років (решта країн)

Таким чином, гіпотези 2.1 і 2.2 не підтвердилися.

## 3.4. Висновки до розділу ІІІ

Таким чином, вплив частки років економічного росту в житті людини слабко впливає на цінності людини. Найбільший цей вплив в умовно європейської Туреччини.

Розподіл особливостей слабко відповідає відомим теоретичним концепціям розмежування Європи, як-от теорія Еспін-Андересена чи поділ Європи на окремі регіони (Західна, Центральна, Східна, Південна Європи). Найбільш помітні відмінності за лінією північ-південь.

Період найбільшої чутливості до економічних коливань у різних країнах дещо коливається. Є загалом 4-ри основні епізоди життя, економічні коливання в які найбільше вплинули на цінності респондентів.

# РОЗДІЛ ІV.  Політичні закономірності розподілу цінностей в Європі

## 4.1. Політика і цінності у світлі соціологічних досліджень

Взаємозв'язок між політикою та цінностями теж є доволі дослідженим. Саме цінності, на думку багатьох дослідників, визначають політичну поведінку громадян. Однак при цьому зворотній вплив є мало дослідженим. Ми припускаємо, що політичний досвід, пережитий індивідами, здатний впливати на їх цінності. Це розділ роботи присвячено аналізу цього припущення. 

Зв'язок між політикою і соціальними цінностями аналізується в тому числі у роботах класиків соціології з дослідження цінностей, таких як Шалом Шварц [@Caprara_2006] (він у співавторстві з іншими дослідниками аналізує те, як цінності впливають на політичний вибір) та Рональд Інглехарт [@Rayside_1978].

Насамперед нас цікавили характеристики політичних інстутів, які існували у час життя індивіда. 

Ми припускаємо, що політична стабільність та характеристики політичних інстутів (їх плюразлізм) здатні суттєво впливати на цінності людей.

## 4.2. Дані політичного розвитку європейських країн

### 4.2.1. База даних політичних інституцій

Для характеристики політичних інститутів у роботі ми використовували дані Бази даних політичних інституцій (DPI -  Database of Political Institutions) [@Scartascini_2018]. 

Ця база база створена за підтримки Міжамериканського банку розвитку та Світового банку. База ведеться з 2000-го року і її найактуальніша версія наразі охоплює період з 1975 по 2017 рік (оновлюється зазвичай раз на два роки). Загалом у базі є дані про близько 180 країн (у тому числі про ті країни, яких уже більше нема). DPI містить змінні, які характеризують тип політичної системи країни, її інституційні та електоральні результати, характеристики стабільності і плюральності політичної системи, характеристики гілок влади, ідеологічні характеристики влади та опозиції, обсяги їх підтримки. Ця база даних є так само як згаданий у попередньому розділі роботи проект Медісона є однією з найбільш цитованих баз даних у порівняльній політичній економіці та порівняльному аналізі політичних інститутів [@Scartascini_2018; @Beck_2001].

### 4.2.2. Створення ознак, що характеризують політичний досвід респондентів

Загалом у масиві даних присутні 125 ознак. Основні з них, які ми використовувалися містяться в таблиці (Додаток).

Оскільки нашою метою було зафіксувати певний досвід, пережитий індивідом, то використовувалася наступна схема розрахунку ознак. Для кожної ознаки з бази даних політичних інституцій ми розрахували середнє, мінімум, максимум, стандартне відхилення та кількість унікальних значень для кожного респондента усіх хвиль ЄСС. 

Бралися до уваги тільки ті респондети, які народилися з 1969 року (таким чином, дані бази відображають стан речей у країнах респондентів протягом їх свідомого життя).

## 4.3. Техніки і процедури дослідження впливу політичного досвіду на цінності

У цьому ррзділі ми використали відмінний від попередніх роздідів підхід до аналізу проблеми. Якщо в розділах 2-3 ми рухались від конкретних гіпотез до їх пеевірки, то тут ми використали так званий Data-driven підхід. Цей підхід не є настільки поширеним, як традиційний, однак дозволяє ширше використати потенціал великих масивів даних [@Roelfs_2013].

Аналіз даних відбувався у чотири етапи:

1) Усунення впливу ознак країни та віку респондента.
Це зумовлено тим, що характеристики інститутів досить сильно пов'язані із країною проживання та віком респондента. Це призводило до того, що ми не могли зрозуміти, чи це на цінності так впливає певна характеристика, чи те, що вона дуже пов'язана із країною, якій притаманна. Тому з кожною ознакою ми зробили лінійну регресію, включивши тільки дві змінні як незалежні - країна та вік респондента. Далі ми дивилися настільки ці ознаки пояснюють кожну характеристику, якщо ці дві ознаки пояснювали більше 50% дисперсії ознаки, то ми таку змінну виключали з аналізу. Якщо R квадрат становив від 10 до 50%, то замість самої ознаки ми використовували залишки регресійного рівняння.
2) Відбір найбільш інформативних змінних через метод градієнтного бустингу дерев;
Цей метод добре себе зарекомендував у виявленні нелінійних закономірностей між змінними (загалом це характерно для усіх методів, які засновані на побудові дерев прийняття рішень). Він став уже класичним у сфері машинного навчання через його дуже високу ефективність порівняно зі звичайними лінійними моделями на зразок лінійної регресії. У соціології цей метод не є широко використовуваним, хоча це може бути пов'язано з тим, що основні реалізації цього методу з'явилися відносно недавно - у 2014-2017 роках [@NIPS2017_6907; @dorogush2018catboost; @Chen:2016:XST:2939672.2939785]. Проте вже є соціологічні дослідження з його використанням, зокрема дослідження волонтерства Ейком Емріхом [@Emrich_2016]. 
3) Встановлення надійності зв'язку між змінним цінностей та найбільш інформативними змінним за домогою t тесту Стьюдента для порівняння середніх значень;
4) Візуалізація зв'язків. Зображення графіків розподілів.

**Таблиця 9. Топ 10 найбільш значущих за впливом ознак**
```{r, echo=FALSE}
loadd(t_test_summary)
t_test_summary %>%
  group_by(depend) %>% 
  top_n(10, `p.value`) %>% 
  flextable::flextable() %>% 
  flextable::autofit(add_w = 0.1, add_h = 0.1)
```

## 4.4. Результати аналізу впливу політичного досвіду на цінності жителів європейських країн

На основі створеної моделі градієнтного бустингу дерев та т-тесту Стьюдента ми виявили політичні змінні, які найбільше впливають на пари цінностей. Т-тест Стьюдента дозволив нам визначити перелік змінних, зв'язок яких із парами цінностей є статистично надійним, у той же час градієнтний бустинг показав, які змінні є найбільш інформативними для пояснення цінностей. Це можна дізнатись із значення показника Gain для кожної змінної. Загалом ми виділили по 9 найбільш інформативних і статистично значущих змінних, які впливають на те, до яких цінностей більш схильна людина.

Найбільший вплив на дихотомію цінностей відкритості до змін та збереження мають наступні цінності (див. Малюнок 10):

1) кількість змін виборчого законодавства протягом життя респондента. Чим частіше воно змінювалось, тим частіше респондент виявлявся більш відкритим до змін.

2) міністр оборони - верховний головнокомандуючий. Респонденти, які живуть/жили за умов, коли командує армією міністр оборони, більш відкриті до змін.

3) провладна партія немає ідеологічного спрямування. Чим довше такі патії були при владі протягом життя респондента, тим більш відкритий він до змін.

4) Мінімальна різніманітність кількісного складу парламенту. Чим більше цей показник протягом життя респондента, тим більш він консервативний.

5) Кількість змін влади. Чим більше змін влади, тим більш відкритий до змін респондент.

6) Кількість змін розміру парламенту. Чим більше таких змін, тим більш відкриті до змін респонденти.

7) мінімальний вік провладних партій. Чим менший їх середній вік, тим відкритіші респонденти до змін.

8) вік патій. Чим старіші парламентські партії, тим більш консервативним є респондент.

9) досвід життя за часів авторитаризму, тоталітаризму. Чим більший такий досвід у людей, тим більш вони є прихильними до цінностей збереження.

**Малюнок 10. Основні політичні фактори, що впливають на пару цінностей Відкритість до змін-Збереження**
```{r, echo=FALSE, fig.width = 9, fig.height=9, message=FALSE, echo=FALSE,warning=FALSE,message=FALSE, dpi=300}
loadd(viz_oc)
viz_oc
```

Найбільший вплив на дихотомію цінностей самовдосконалення та самоперевершення мають наступні цінності (див. Малюнок 11):

1) кількість змін влади. Чим частіше змінювалася влада протягом життя респондента, тим більш він схильний до цінностей саморозвитку.

2) відсутність ідеології в правлячої партії. Чим більше років правили такі партії протягом життя респондента, тим більше він схильний до цінностей самоперевершення.

3) зміна складу опозиції. Чим частіше змінювалася опозиція протягом життя респондента, тим більше він схильний до цінностей саморозвитку.

4) вік головної опозиційної партії. Чим старші партії опинялися в опозиції до влади протягом життя респондента, тим більш він схильний до цінностей саморозвитку.

5) кількість опозиційних партій в парламенті. Чим більше в середньому протягом життя респондента було партій в опозиції, тим більш він схильний до цінностей саморозвитку.

6) максимальний вік партії в парламенті. Чим старші в середньому протягом життя респондента були партії в парламенті, тим більш він схильний до цінностей саморозвитку.

7) мінімальний вік партії в парламенті. Чим молодші в середньому протягом життя респондента були партії в парламенті, тим більш він схильний до цінностей саморозвитку.

8) наявність досвіду життя в умовах авторитаризму. Наявність досвіду життя респондента в умовах авторитаризму збільшує його схильність до цінностей саморозвитку.

9) наявність досвіду життя в умовах тоталітаризму. Наявність досвіду життя респондента в умовах тоталітаризму збільшує його схильність до цінностей саморозвитку.

**Малюнок 11. Основні політичні фактори, що впливають на пару цінностей Самовдосконалення-Самоперевершення**
```{r, echo=FALSE, fig.width = 9, fig.height=9, message=FALSE, echo=FALSE,warning=FALSE,message=FALSE, dpi=300}
loadd(viz_st)
viz_st
```

## 4.5. Висновки до розділу IV

Отже, пережитий політичний досвід респондентів ЄСС має вплив на їх цінності. Однак цей досвід переважно обмежується факторами життя в умовах авторитарної чи тоталітарної системи, що впливає відкритість до змін, наявності політичних традицій і культури в країнах проживання. Також досить впливовими на цінності є фактори, що свідчать про наявність політичних трансформацій у державах протягом життя респондентів. Наявність досвіду життя в часи трансформацій сприяє тому, що респонденти стають більш відкритими до змін. 

# Висновки

Таким чином, у ході нашого дослідження ми виконали усі поставлені завдання та досягли мети роботи.

Дана робота демонструє можливості використання економічних та політичних даних у комбінації з даними соціологічних опитувань (ЄСС). Так, у другому розділі роботи ми поєднали дані ЄСС із географічними даними європейських регіонів і проаналізували вплив сусідства на цінності. У третьому розділі ми визначили зв'язок між економічними досвідом, пережитим індивідами, і їх цінностями, скомбінувавши дані ЄСС із даними проекту Медісона з історичної оцінкии ВВП країн за паритетом купівельної спроможності. У четвертому розділі ми використали дані Бази даних політичних інстититів і змогли оцінити, як пережитий політичний досвід пов'язаний із цінностями, що знову ж таки висвітлені через дані ЄСС. Таким чином, у роботі представлено не просто порівняльний аналіз цінностей, а й аналіз використанням даних із суміжних з соціологією областей. Такий підхід до дослідження цінностей є одніє з особливостей цієї роботи.

Другою головною особливістю роботи є аналіз зв'язку цінностей з економікою та політикою. Зазвичай аналізується вплив цінностей на політичний та економічний розвиток. У нашій роботі представлено аналіз того, як економічний та політичний досвіди впливають на цінності індивіда.

З аналізу гегорафічних сусідств стало видно, що ціннісні кордони у Європі присутні. Так, основні лінії розлому - класичні - Підне-Північ, Захід-Схід. Кластерний аналіз цінностей показав, що існує три основних ціннісних кластери у Європі (Північно-Західна Європа, Південна Європа і Східна Європа (посткомуністична)). 

Важливо зауважити, що ціннісні кордони між країнами Європи (у тому числі тих, які входять давно у Європейський Союз) помітні. Однак аналіз різних вікових груп показав, що існує тенденція до стирання ціннісних кордонів між країнами Європи. Так, молодь (до 35 років) у Європі є більш ціннісно схожою, ніж старше покоління (60+ років). Це є свідченням того, що єдиний європейський ціннісний простір продовжує формуватися. 

Аналіз впливу економічного досвіду індивідів (конкретно - досвіду пережитих економічних спадів) на їх цінності показав загалом невеликий вплив цього фатора на цінності (більше впливав цей досвід на пару Відкритість до змін - Збереження). Але при цьому ми виявили різні кластери країн, де цей вплив відігравав біьшу роль у різні вікові періоди. Так, у країнах Півдня Європи до економічних коливань є більщ чутливим старше населення, тоді як населення Північної Європи більш чутливе у часи молодості.

Дослідження зв'язку політичного досвіду і цінностей показало, що пеежитий досвід низької низької політичної стабільності сприяє більшій відкритості до змін, натомість сильна політична стабільність і досвід життя при авторитаризмі сприяє більшій прихильності до цінностей збереження. Цінності самовдосконалення властиві тим респондентам, які мали більший досвід життя за умов високого дотримання політичних традицій і культури (що виявлялось, наприклад, у домінуванні в політичній системі партій, яким більше 50 років). У той же час цінності самоподолання характерні людям, які перрежили досвід низьких політичних традицій, що виражаються у частому приході до влади абсолютно нових політичних сил.

Для аналізу висунутих гіпотез у роботі використовувався ряд методів: кореляційний аналіз (для виявлення взаємозв'язку між змінними, використовувався при аналізі впливу економіки на цінності), одновимірний дисперсійний аналіз (ANOVA) (використовувався при аналізі впливу економіки на цінності), аналіз просторових автокореляцій, зокрема розрахунок індексу просторової автокореляції Морана І, (для аналізу впливу географічного сусідства на цінності), t-тест Стьюдента для порівняння середніх значень (для аналізу впливу змінних, що характеризували політичний розвиток країн, на цінності індивідів), градієнтний бустинг дерев прийняття рішень (для виявлення найбільш інформатиних змінних з великого числа політичних факторів, які найкраще пояснюють схильність індивідів до тих чи інших цінностей). Використання таких методів як аналіз просторових автокореляцій та градієнтний бустинг - це новинка для соціологінчих досліджень, переважна сфера застосування цих методів в Україні - економічні дослідження та прикладна статистика. 

Таким чином, у рамках магістерської роботи нам вдалося проаналізувати фактори географічного розподілу цінностей у Європі, що було відображено через автокореляційний аналіз географічних сусідств, аналіз впливу пережитого економічного та політичного досвіду індивідом на його соціальні цінності. Втім, дана робота не вичерпує потенціал подальших досліджень гегорафічного розподілу цінностей у Європі, оскільки потенційно цих фаторів може бути набагато більше, проте існуючі масиви даних дозволяють якісно проаналізувати саме вище згадані фактори. Дана робота розширює розуміння того, що впливає на розподіл цінностей жителів Європи, та показує, наскільки швидко відбувається ціннісна уніфікація населення країн Європи. 


# Список використаних джерел та література

<div id="refs"></div>
```{r refmgr references, results="asis", echo=FALSE}
# PrintBibliography(bib) 
```

# Додатки

## Додаток 1

Системні особливості

```{r, echo=FALSE}
version
```

## Додаток 2

```{r, eval=FALSE}
#' Географічний розподіл соціальних цінностей у Європі: фактори та закономірності
#' Geographical distribution of social values in Europe: factors and patterns
#' Географическое распределение социальных ценностей в Европе: факторы и закономерности


library(drake)

source("functions.R")
source("predef.R")

plan <- drake_plan(
  ess = purrr::map_dfr(list.files(path = "~/social_data_analysis/data/", pattern = ".sav", full.names = T), 
                       function(x) { 
                         foreign::read.spss(x, to.data.frame = T) %>% as_tibble()
                       }) %>% 
    mutate(
      cntry = as.character(cntry),
      round_year = case_when(
        essround == 1 ~ 2002, essround == 2 ~ 2004,
        essround == 3 ~ 2006, essround == 4 ~ 2008,
        essround == 5 ~ 2010, essround == 6 ~ 2012,
        essround == 7 ~ 2014, essround == 8 ~ 2016
      ),
      region = dplyr::select(.,starts_with("region")) %>% as.matrix() %>% 
        apply(1, function(x) x[!is.na(x)][1]),
      region = ifelse(is.na(region), cntry, region) %>% stringr::str_squish(),
      agea = as.numeric(agea)
    ) %>% 
    shwartz_4() %>% 
    shwartz_10() %>% 
    dplyr::select(
      round_year, cntry, region, agea,
      security, conformity, tradition, benevolence, universalism, universalism,
      self_direction, stimulation, hedonism, achievement, power,
      `Self-Enhancement`, Conservation, `Self-Trancendence`, `Openness to Change`
    ) %>% ess_region(),
  reg = rbind(
    readr::read_rds("~/social_data_analysis/data/gadm36_NOR_1_sp.rds") %>% 
      mutate(
        NAME_1 = case_when(
          NAME_1 == "Akershus" ~ "Oslo and Akershus",
          NAME_1 == "Ãstfold" ~ "South Eastern Norway",
          NAME_1 == "Aust-Agder" ~ "Agder and Rogaland",
          NAME_1 == "Buskerud" ~ "South Eastern Norway",
          NAME_1 == "Finnmark" ~ "Northern Norway",
          NAME_1 == "Hedmark" ~ "Hedmark and Oppland",
          NAME_1 == "Hordaland" ~ "Western Norway",
          NAME_1 == "Møre og Romsdal" ~ "Western Norway",
          NAME_1 == "Nord-Trøndelag" ~ "Trøndelag",
          NAME_1 == "Nordland" ~ "Northern Norway",
          NAME_1 == "Oppland" ~ "Hedmark and Oppland",
          NAME_1 == "Oslo" ~ "Oslo and Akershus",
          NAME_1 == "Rogaland" ~ "Agder and Rogaland",
          NAME_1 == "Sogn og Fjordane" ~ "Western Norway",
          NAME_1 == "Sør-Trøndelag" ~ "Trøndelag",
          NAME_1 == "Telemark" ~ "South Eastern Norway",
          NAME_1 == "Troms" ~ "Northern Norway",
          NAME_1 == "Vest-Agder" ~ "Agder and Rogaland",
          NAME_1 == "Vestfold" ~ "South Eastern Norway"
        )
      ) %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_BEL_1_sp.rds") %>% 
      mutate(
        NAME_1 = case_when(
          NAME_1 == "Bruxelles" ~ "Brussels region",
          NAME_1 == "Wallonie" ~ "Walloon region",
          NAME_1 == "Vlaanderen" ~ "Flemish region"
        )
      ) %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_CHE_1_sp.rds") %>% 
      mutate(
        NAME_1 = case_when(
          NAME_1 == "Valais" ~ "Genferseeregion",
          NAME_1 == "Vaud" ~ "Genferseeregion",
          NAME_1 == "Genève" ~ "Genferseeregion",
          NAME_1 == "Bern" ~ "Zentrales Mittelland",
          NAME_1 == "Fribourg" ~ "Zentrales Mittelland",
          NAME_1 == "Jura" ~ "Zentrales Mittelland",
          NAME_1 == "Solothurn" ~ "Zentrales Mittelland",
          NAME_1 == "Neuchâtel" ~ "Zentrales Mittelland",
          NAME_1 == "Aargau" ~ "Nordschweiz",
          NAME_1 == "Basel-Landschaft" ~ "Nordschweiz",
          NAME_1 == "Basel-Stadt" ~ "Nordschweiz",
          NAME_1 == "Uri" ~ "Zentralschweiz",
          NAME_1 == "Schwyz" ~ "Zentralschweiz",
          NAME_1 == "Obwalden" ~ "Zentralschweiz",
          NAME_1 == "Nidwalden" ~ "Zentralschweiz",
          NAME_1 == "Lucerne" ~ "Zentralschweiz",
          NAME_1 == "Zug" ~ "Zentralschweiz",
          NAME_1 == "Ticino" ~ "Tessin",
          NAME_1 == "Zürich" ~ "Nordschweiz",
          NAME_1 == "Uri" ~ "Zentralschweiz",
          NAME_1 == "Sankt Gallen" ~ "Ostschweiz",
          NAME_1 == "Thurgau" ~ "Ostschweiz",
          NAME_1 == "Appenzell Innerrhoden" ~ "Ostschweiz",
          NAME_1 == "Appenzell Ausserrhoden" ~ "Ostschweiz",
          NAME_1 == "Glarus" ~ "Ostschweiz",
          NAME_1 == "Schaffhausen" ~ "Ostschweiz",
          NAME_1 == "Graubünden" ~ "Ostschweiz"
        )
      ) %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_CZE_1_sp.rds") %>% 
      mutate(
        NAME_1 = case_when(
          NAME_1 == "Jihočeský" ~ "South Bohemia",
          NAME_1 == "Jihomoravský" ~ "South Moravia",
          NAME_1 == "Karlovarský" ~ "Karlovy Vary Reg.",
          NAME_1 == "Kraj Vysočina" ~ "Vysocina",
          NAME_1 == "Královéhradecký" ~ "Hradec Kralove Reg.",
          NAME_1 == "Liberecký" ~ "Liberec Reg.",
          NAME_1 == "Moravskoslezský" ~ "Moravian Silesia Reg.",
          NAME_1 == "Olomoucký" ~ "Olomouc Reg.",
          NAME_1 == "Pardubický" ~ "Pardubice Reg.",
          NAME_1 == "Plzeňský" ~ "Plzen Reg.",
          NAME_1 == "Prague" ~ "Prague",
          NAME_1 == "Středočeský" ~ "Central Bohemia",
          NAME_1 == "Ústecký" ~ "Usti Reg.",
          NAME_1 == "Zlínský" ~ "Zlin Reg."
        )
      ) %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_SWE_1_sp.rds") %>% 
      mutate(
        NAME_1 = case_when(
          NAME_1 == "Blekinge" ~ "Sydsverige",
          NAME_1 == "Dalarna" ~ "Norra Mellansverige",
          NAME_1 == "Gävleborg" ~ "Norra Mellansverige",
          NAME_1 == "Gotland" ~ "Småland och Öarna",
          NAME_1 == "Halland" ~ "Västsverige",
          NAME_1 == "Jämtland" ~ "Mellemsta Norrland",
          NAME_1 == "Jönköping" ~ "Småland och Öarna",
          NAME_1 == "Kalmar" ~ "Småland och Öarna",
          NAME_1 == "Kronoberg" ~ "Småland och Öarna",
          NAME_1 == "Norrbotten" ~ "Övre Norrland",
          NAME_1 == "Orebro" ~ "Östra Mellansverige",
          NAME_1 == "Östergötland" ~ "Östra Mellansverige",
          NAME_1 == "Skåne" ~ "Sydsverige",
          NAME_1 == "Södermanland" ~ "Östra Mellansverige",
          NAME_1 == "Stockholm" ~ "Stockholm",
          NAME_1 == "Uppsala" ~ "Östra Mellansverige",
          NAME_1 == "Värmland" ~ "Norra Mellansverige",
          NAME_1 == "Västerbotten" ~ "Övre Norrland",
          NAME_1 == "Västernorrland" ~ "Mellemsta Norrland",
          NAME_1 == "Västmanland" ~ "Östra Mellansverige",
          NAME_1 == "Västra Götaland" ~ "Västsverige"
        )
      ) %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_EST_1_sp.rds") %>% 
      mutate(
        NAME_1 = case_when(
          NAME_1 == "Harju" ~ "Põhja-Eesti",
          NAME_1 == "Hiiu" ~ "Lääne-Eesti",
          NAME_1 == "Ida-Viru" ~ "Kirde-Eesti",
          NAME_1 == "Järva" ~ "Kesk-Eesti",
          NAME_1 == "Jõgeva" ~ "Lõuna-Eesti",
          NAME_1 == "Lääne" ~ "Lääne-Eesti",
          NAME_1 == "Lääne-Viru" ~ "Kesk-Eesti",
          NAME_1 == "Pärnu" ~ "Lääne-Eesti",
          NAME_1 == "Peipsi" ~ "Lõuna-Eesti",
          NAME_1 == "Põlva" ~ "Lõuna-Eesti",
          NAME_1 == "Rapla" ~ "Kesk-Eesti",
          NAME_1 == "Saare" ~ "Lääne-Eesti",
          NAME_1 == "Tartu" ~ "Lõuna-Eesti",
          NAME_1 == "Valga" ~ "Lõuna-Eesti",
          NAME_1 == "Viljandi" ~ "Kesk-Eesti",
          NAME_1 == "Võru" ~ "Lõuna-Eesti"
        )
      ) %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_LUX_1_sp.rds") %>% 
      mutate(
        NAME_1 = "Luxembourg"
      ) %>% unite(),
    readr::read_rds("~/social_data_analysis/data/gadm36_FRA_1_sp.rds") %>% 
      mutate(
        NAME_1 = case_when(
          NAME_1 == "Auvergne-Rhône-Alpes" ~ "Sud Est",
          NAME_1 == "Bourgogne-Franche-Comté" ~ "Bassin Parisien Est",
          NAME_1 == "Bretagne" ~ "Ouest",
          NAME_1 == "Centre-Val de Loire" ~ "Bassin Parisien Ouest",
          NAME_1 == "Corse" ~ "Méditerranée",
          NAME_1 == "Grand Est" ~ "Est",
          NAME_1 == "Hauts-de-France" ~ "Nord",
          NAME_1 == "Île-de-France" ~ "Région parisienne",
          NAME_1 == "Normandie" ~ "Nord",
          NAME_1 == "Nouvelle-Aquitaine" ~ "Sud Ouest",
          NAME_1 == "Occitanie" ~ "Sud Ouest",
          NAME_1 == "Pays de la Loire" ~ "Ouest",
          NAME_1 == "Provence-Alpes-Côte d'Azur" ~ "Méditerranée"
        )
      ) %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_HRV_1_sp.rds") %>% 
      mutate(
        NAME_1 = case_when(
          NAME_1 == "Bjelovarska-Bilogorska" ~ "Sredisnja i Istocna (Panonska) Hrvatska",
          NAME_1 == "Brodsko-Posavska" ~ "Sredisnja i Istocna (Panonska) Hrvatska",
          NAME_1 == "Dubrovacko-Neretvanska" ~ "Jadranska Hrvatska",
          NAME_1 == "Grad Zagreb" ~ "Sjeverozapadna Hrvatska",
          NAME_1 == "Istarska" ~ "Jadranska Hrvatska",
          NAME_1 == "Karlovacka" ~ "Sredisnja i Istocna (Panonska) Hrvatska",
          NAME_1 == "Koprivničko-Križevačka" ~ "Sjeverozapadna Hrvatska",
          NAME_1 == "Krapinsko-Zagorska" ~ "Sjeverozapadna Hrvatska",
          NAME_1 == "Licko-Senjska" ~ "Jadranska Hrvatska",
          NAME_1 == "Medimurska" ~ "Sjeverozapadna Hrvatska",
          NAME_1 == "Osjecko-Baranjska" ~ "Sredisnja i Istocna (Panonska) Hrvatska",
          NAME_1 == "Požeško-Slavonska" ~ "Sredisnja i Istocna (Panonska) Hrvatska",
          NAME_1 == "Primorsko-Goranska" ~ "Jadranska Hrvatska",
          NAME_1 == "Šibensko-Kninska" ~ "Jadranska Hrvatska",
          NAME_1 == "Sisacko-Moslavacka" ~ "Sredisnja i Istocna (Panonska) Hrvatska",
          NAME_1 == "Splitsko-Dalmatinska" ~ "Jadranska Hrvatska",
          NAME_1 == "Varaždinska" ~ "Sjeverozapadna Hrvatska",
          NAME_1 == "Viroviticko-Podravska" ~ "Sredisnja i Istocna (Panonska) Hrvatska",
          NAME_1 == "Vukovarsko-Srijemska" ~ "Sredisnja i Istocna (Panonska) Hrvatska",
          NAME_1 == "Zadarska" ~ "Jadranska Hrvatska",
          NAME_1 == "Zagrebačka" ~ "Sjeverozapadna Hrvatska"
        )
      ) %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_PRT_1_sp.rds") %>% 
      mutate(
        NAME_1 = case_when(
          NAME_1 == "Aveiro" ~ "Centro",
          NAME_1 == "Azores" ~ "Algarve",
          NAME_1 == "Beja" ~ "Alentejo",
          NAME_1 == "Braga" ~ "Norte",
          NAME_1 == "Bragança" ~ "Norte",
          NAME_1 == "Castelo Branco" ~ "Centro",
          NAME_1 == "Coimbra" ~ "Centro",
          NAME_1 == "Évora" ~ "Alentejo",
          NAME_1 == "Faro" ~ "Algarve",
          NAME_1 == "Guarda" ~ "Centro",
          NAME_1 == "Leiria" ~ "Centro",
          NAME_1 == "Lisboa" ~ "Lisboa e Vale do Tejo",
          NAME_1 == "Madeira" ~ "Algarve",
          NAME_1 == "Portalegre" ~ "Alentejo",
          NAME_1 == "Porto" ~ "Norte",
          NAME_1 == "Santarém" ~ "Alentejo",
          NAME_1 == "Setúbal" ~ "Alentejo",
          NAME_1 == "Viana do Castelo" ~ "Norte",
          NAME_1 == "Vila Real" ~ "Norte",
          NAME_1 == "Viseu" ~ "Centro"
        )
      ) %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_SVK_1_sp.rds") %>% 
      mutate(
        NAME_1 = case_when(
          NAME_1 == "Banskobystrický" ~ "Banska Bystrica Reg.",
          NAME_1 == "Bratislavský" ~ "Bratislava Reg.",
          NAME_1 == "Košický" ~ "Kosice Reg.",
          NAME_1 == "Nitriansky" ~ "Nitra Reg.",
          NAME_1 == "Prešovský" ~ "Presov Reg.",
          NAME_1 == "Trenčiansky" ~ "Trencin Reg.",
          NAME_1 == "Trnavský" ~ "Trnava Reg.",
          NAME_1 == "Žilinský" ~ "Zilina Reg."
        )
      ) %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_LTU_1_sp.rds") %>% 
      mutate(
        NAME_1 = case_when(
          NAME_1 == "Alytaus" ~ "South Lithuania",
          NAME_1 == "Klaipedos" ~ "West Lithuania",
          NAME_1 == "Marijampoles" ~ "South Lithuania",
          NAME_1 == "Panevezio" ~ "Nord Lithuania",
          NAME_1 == "Šiauliai" ~ "Nord Lithuania",
          NAME_1 == "Taurages" ~ "West Lithuania",
          NAME_1 == "Telšiai" ~ "West Lithuania",
          NAME_1 == "Utenos" ~ "Nord Lithuania",
          T ~ NAME_1
        )
      ) %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_LVA_1_sp.rds") %>% 
      mutate(
        NAME_1 = case_when(
          NAME_1 == "Kurzeme" ~ "Nord-West Latvia",
          NAME_1 == "Latgale" ~ "South-East Latvia",
          NAME_1 == "Riga" ~ "Nord-West Latvia",
          NAME_1 == "Vidzeme" ~ "South-East Latvia",
          NAME_1 == "Zemgale" ~ "South-East Latvia"
        )
      ) %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_XKO_1_sp.rds") %>% 
      mutate(
        NAME_1 = case_when(
          NAME_1 == "Đakovica" ~ "South Kosovo",
          NAME_1 == "Gnjilane" ~ "South Kosovo",
          NAME_1 == "Kosovska Mitrovica" ~ "Nord Kosovo",
          NAME_1 == "Pećki" ~ "Nord Kosovo",
          NAME_1 == "Pristina" ~ "Nord Kosovo",
          NAME_1 == "Prizren" ~ "South Kosovo",
          NAME_1 == "Uroševac" ~ "South Kosovo"
        )
      ) %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_SVN_1_sp.rds") %>% unite(),
    readr::read_rds("~/social_data_analysis/data/gadm36_ROU_1_sp.rds") %>% 
      mutate(
        NAME_1 = case_when(
          NAME_1 == "Alba" ~ "Centru",
          NAME_1 == "Arad" ~ "Vest",
          NAME_1 == "Argeș" ~ "Sud-Muntenia",
          NAME_1 == "Bacău" ~ "Nord-Est",
          NAME_1 == "Bihor" ~ "Nord-Vest",
          NAME_1 == "Bistrița-Năsăud" ~ "Nord-Vest",
          NAME_1 == "Botoșani" ~ "Nord-Est",
          NAME_1 == "Brașov" ~ "Centru",
          NAME_1 == "Brăila" ~ "Sud-Est",
          NAME_1 == "Bucharest" ~ "Bucuresti-Ilfov",
          NAME_1 == "Buzău" ~ "Sud-Est",
          NAME_1 == "Călărași" ~ "Sud-Muntenia",
          NAME_1 == "Caraș-Severin" ~ "Vest",
          NAME_1 == "Cluj" ~ "Nord-Vest",
          NAME_1 == "Constanța" ~ "Sud-Est",
          NAME_1 == "Covasna" ~ "Centru",
          NAME_1 == "Dâmbovița" ~ "Sud-Muntenia",
          NAME_1 == "Dolj" ~ "Sud-Vest Oltenia",
          NAME_1 == "Galați" ~ "Sud-Est",
          NAME_1 == "Giurgiu" ~ "Sud-Muntenia",
          NAME_1 == "Gorj" ~ "Sud-Vest Oltenia",
          NAME_1 == "Harghita" ~ "Centru",
          NAME_1 == "Hunedoara" ~ "Vest",
          NAME_1 == "Iași" ~ "Nord-Est",
          NAME_1 == "Ialomița" ~ "Sud-Muntenia",
          NAME_1 == "Ilfov" ~ "Bucuresti-Ilfov",
          NAME_1 == "Maramureș" ~ "Nord-Vest",
          NAME_1 == "Mehedinți" ~ "Sud-Vest Oltenia",
          NAME_1 == "Mureș" ~ "Centru",
          NAME_1 == "Neamț" ~ "Nord-Est",
          NAME_1 == "Olt" ~ "Sud-Vest Oltenia",
          NAME_1 == "Prahova" ~ "Sud-Muntenia",
          NAME_1 == "Sălaj" ~ "Nord-Vest",
          NAME_1 == "Satu Mare" ~ "Nord-Vest",
          NAME_1 == "Sibiu" ~ "Centru",
          NAME_1 == "Suceava" ~ "Nord-Est",
          NAME_1 == "Teleorman" ~ "Sud-Muntenia",
          NAME_1 == "Timiș" ~ "Vest",
          NAME_1 == "Tulcea" ~ "Sud-Est",
          NAME_1 == "Vâlcea" ~ "Sud-Vest Oltenia",
          NAME_1 == "Vaslui" ~ "Nord-Est",
          NAME_1 == "Vrancea" ~ "Sud-Est"
        )) %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_HUN_1_sp.rds") %>% 
      mutate(
        NAME_1 = case_when(
          NAME_1 == "Bács-Kiskun" ~ "South- Plain",
          NAME_1 == "Baranya" ~ "South-Transdanubia",
          NAME_1 == "Békés" ~ "South- Plain",
          NAME_1 == "Borsod-Abaúj-Zemplén" ~ "North Regio",
          NAME_1 == "Budapest" ~ "Central regio",
          NAME_1 == "Csongrád" ~ "South- Plain",
          NAME_1 == "Fejér" ~ "Middle- Transdanubia",
          NAME_1 == "Gyor-Moson-Sopron" ~ "West- Transdanubia",
          NAME_1 == "Hajdú-Bihar" ~ "North- Plain",
          NAME_1 == "Heves" ~ "North Regio",
          NAME_1 == "Jász-Nagykun-Szolnok" ~ "North- Plain",
          NAME_1 == "Komárom-Esztergom" ~ "Middle- Transdanubia",
          NAME_1 == "Nógrád" ~ "North Regio",
          NAME_1 == "Pest" ~ "Central regio",
          NAME_1 == "Somogy" ~ "South-Transdanubia",
          NAME_1 == "Szabolcs-Szatmár-Bereg" ~ "North- Plain",
          NAME_1 == "Tolna" ~ "South-Transdanubia",
          NAME_1 == "Vas" ~ "West- Transdanubia",
          NAME_1 == "Veszprém" ~ "Middle- Transdanubia",
          NAME_1 == "Zala" ~ "West- Transdanubia"
        )) %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_BGR_1_sp.rds") %>% 
      mutate(
        NAME_1 = case_when(
          NAME_1 == "Blagoevgrad" ~ "South Western",
          NAME_1 == "Burgas" ~ "South Eastern",
          NAME_1 == "Dobrich" ~ "North Eastern",
          NAME_1 == "Gabrovo" ~ "North Central",
          NAME_1 == "Grad Sofiya" ~ "South Western",
          NAME_1 == "Haskovo" ~ "South Central",
          NAME_1 == "Kardzhali" ~ "South Central",
          NAME_1 == "Kyustendil" ~ "South Western",
          NAME_1 == "Lovech" ~ "North Western",
          NAME_1 == "Montana" ~ "North Western",
          NAME_1 == "Pazardzhik" ~ "South Central",
          NAME_1 == "Pernik" ~ "South Western",
          NAME_1 == "Pleven" ~ "North Western",
          NAME_1 == "Plovdiv" ~ "South Central",
          NAME_1 == "Razgrad" ~ "North Central",
          NAME_1 == "Ruse" ~ "North Central",
          NAME_1 == "Shumen" ~ "North Eastern",
          NAME_1 == "Silistra" ~ "North Central",
          NAME_1 == "Sliven" ~ "South Eastern",
          NAME_1 == "Smolyan" ~ "South Central",
          NAME_1 == "Sofia" ~ "South Western",
          NAME_1 == "Stara Zagora" ~ "South Eastern",
          NAME_1 == "Targovishte" ~ "North Eastern",
          NAME_1 == "Varna" ~ "North Eastern",
          NAME_1 == "Veliko Tarnovo" ~ "North Central",
          NAME_1 == "Vidin" ~ "North Western",
          NAME_1 == "Vratsa" ~ "North Western",
          NAME_1 == "Yambol" ~ "South Eastern"
        )) %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_IRL_1_sp.rds") %>% 
      mutate(
        NAME_1 = case_when(
          NAME_1 == "Carlow" ~ "South-Ireland",
          NAME_1 == "Cavan" ~ "Border",
          NAME_1 == "Clare" ~ "South-Ireland",
          NAME_1 == "Cork" ~ "South-Ireland",
          NAME_1 == "Donegal" ~ "Border",
          NAME_1 == "Dublin" ~ "Dublin",
          NAME_1 == "Galway" ~ "West",
          NAME_1 == "Kerry" ~ "South-Ireland",
          NAME_1 == "Kildare" ~ "South-Ireland",
          NAME_1 == "Kilkenny" ~ "South-Ireland",
          NAME_1 == "Laoighis" ~ "Midland",
          NAME_1 == "Leitrim" ~ "Border",
          NAME_1 == "Limerick" ~ "South-Ireland",
          NAME_1 == "Longford" ~ "Midland",
          NAME_1 == "Louth" ~ "Border",
          NAME_1 == "Mayo" ~ "West",
          NAME_1 == "Meath" ~ "South-Ireland",
          NAME_1 == "Monaghan" ~ "Border",
          NAME_1 == "Offaly" ~ "Midland",
          NAME_1 == "Roscommon" ~ "West",
          NAME_1 == "Sligo" ~ "Border",
          NAME_1 == "Tipperary" ~ "South-Ireland",
          NAME_1 == "Waterford" ~ "South-Ireland",
          NAME_1 == "Westmeath" ~ "South-Ireland",
          NAME_1 == "Wexford" ~ "South-Ireland",
          NAME_1 == "Wicklow" ~ "South-Ireland"
        )) %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_RUS_1_sp.rds") %>% 
      mutate(
        NAME_1 = case_when(
          NAME_1 == "Adygey" ~ "North Caucasus",
          NAME_1 == "Altay" ~ "West Siberia",
          NAME_1 == "Amur" ~ "Far East",
          NAME_1 == "Arkhangel'sk" ~ "North and North West",
          NAME_1 == "Astrakhan'" ~ "Volga",
          NAME_1 == "Bashkortostan" ~ "Urals",
          NAME_1 == "Belgorod" ~ "Central-Chernozhem",
          NAME_1 == "Bryansk" ~ "Center",
          NAME_1 == "Buryat" ~ "Far East",
          NAME_1 == "Chechnya" ~ "North Caucasus",
          NAME_1 == "Chelyabinsk" ~ "Urals",
          NAME_1 == "Chukot" ~ "Far East",
          NAME_1 == "Chuvash" ~ "Volgo-Vyatsky",
          NAME_1 == "City of St. Petersburg" ~ "North and North West",
          NAME_1 == "Dagestan" ~ "North Caucasus",
          NAME_1 == "Gorno-Altay" ~ "East Siberia",
          NAME_1 == "Ingush" ~ "North Caucasus",
          NAME_1 == "Irkutsk" ~ "East Siberia",
          NAME_1 == "Ivanovo" ~ "Center",
          NAME_1 == "Kabardin-Balkar" ~ "North Caucasus",
          NAME_1 == "Kaliningrad" ~ "North and North West",
          NAME_1 == "Kalmyk" ~ "Volga",
          NAME_1 == "Kaluga" ~ "Center",
          NAME_1 == "Kamchatka" ~ "Far East",
          NAME_1 == "Karachay-Cherkess" ~ "North Caucasus",
          NAME_1 == "Karelia" ~ "North and North West",
          NAME_1 == "Kemerovo" ~ "West Siberia",
          NAME_1 == "Khabarovsk" ~ "Far East",
          NAME_1 == "Khakass" ~ "East Siberia",
          NAME_1 == "Khanty-Mansiy" ~ "West Siberia",
          NAME_1 == "Kirov" ~ "Volgo-Vyatsky",
          NAME_1 == "Komi" ~ "North and North West",
          NAME_1 == "Kostroma" ~ "Center",
          NAME_1 == "Krasnodar" ~ "North Caucasus",
          NAME_1 == "Krasnoyarsk" ~ "East Siberia",
          NAME_1 == "Kurgan" ~ "Urals",
          NAME_1 == "Kursk" ~ "Central-Chernozhem",
          NAME_1 == "Leningrad" ~ "North and North West",
          NAME_1 == "Lipetsk" ~ "Central-Chernozhem",
          NAME_1 == "Maga Buryatdan" ~ "Far East",
          NAME_1 == "Mariy-El" ~ "Volgo-Vyatsky",
          NAME_1 == "Mordovia" ~ "Volgo-Vyatsky",
          NAME_1 == "Moscow City" ~ "Center",
          NAME_1 == "Moskva" ~ "Center",
          NAME_1 == "Murmansk" ~ "North and North West",
          NAME_1 == "Nenets" ~ "North and North West",
          NAME_1 == "Nizhegorod" ~ "Volgo-Vyatsky",
          NAME_1 == "North Ossetia" ~ "North Caucasus",
          NAME_1 == "Novgorod" ~ "North and North West",
          NAME_1 == "Novosibirsk" ~ "West Siberia",
          NAME_1 == "Omsk" ~ "West Siberia",
          NAME_1 == "Orel" ~ "Center",
          NAME_1 == "Orenburg" ~ "Urals",
          NAME_1 == "Penza" ~ "Volga",
          NAME_1 == "Perm'" ~ "Urals",
          NAME_1 == "Primor'ye" ~ "Far East",
          NAME_1 == "Pskov" ~ "North and North West",
          NAME_1 == "Rostov" ~ "North Caucasus",
          NAME_1 == "Ryazan'" ~ "Center",
          NAME_1 == "Sakha" ~ "Far East",
          NAME_1 == "Sakhalin" ~ "Far East",
          NAME_1 == "Samara" ~ "Volga",
          NAME_1 == "Saratov" ~ "Volga",
          NAME_1 == "Smolensk" ~ "Center",
          NAME_1 == "Stavropol'" ~ "North Caucasus",
          NAME_1 == "Sverdlovsk" ~ "Urals",
          NAME_1 == "Tambov" ~ "Central-Chernozhem",
          NAME_1 == "Tatarstan" ~ "Volga",
          NAME_1 == "Tomsk" ~ "West Siberia",
          NAME_1 == "Tula" ~ "Center",
          NAME_1 == "Tuva" ~ "East Siberia",
          NAME_1 == "Tver'" ~ "Center",
          NAME_1 == "Tyumen'" ~ "West Siberia",
          NAME_1 == "Udmurt" ~ "Urals",
          NAME_1 == "Ul'yanovsk" ~ "Volga",
          NAME_1 == "Vladimir" ~ "Center",
          NAME_1 == "Volgograd" ~ "Volga",
          NAME_1 == "Vologda" ~ "North and North West",
          NAME_1 == "Voronezh" ~ "Central-Chernozhem",
          NAME_1 == "Yamal-Nenets" ~ "West Siberia",
          NAME_1 == "Yaroslavl'" ~ "Center",
          NAME_1 == "Yevrey" ~ "Far East",
          NAME_1 == "Zabaykal'ye" ~ "East Siberia",
        )
      ) %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_ITA_1_sp.rds") %>% 
      mutate(
        NAME_1 = case_when(
          NAME_1 == "Molise" ~ "Centre Italy",
          NAME_1 == "Valle d'Aosta" ~ "Piemonte",
          NAME_1 == "Trentino-Alto Adige" ~ "Veneto",
          NAME_1 == "Friuli-Venezia Giulia" ~ "Veneto",
          NAME_1 == "Veneto" ~ "Veneto",
          NAME_1 == "Liguria" ~ "Piemonte",
          NAME_1 == "Piemonte" ~ "Piemonte",
          NAME_1 == "Emilia-Romagna" ~ "Emilia-Romagna-Toscana",
          NAME_1 == "Toscana" ~ "Emilia-Romagna-Toscana",
          NAME_1 == "Lazio" ~ "Centre Italy",
          NAME_1 == "Abruzzo" ~ "Centre Italy",
          NAME_1 == "Marche" ~ "Centre Italy",
          NAME_1 == "Umbria" ~ "Centre Italy",
          NAME_1 == "Campania" ~ "South Italy",
          NAME_1 == "Apulia" ~ "South Italy",
          NAME_1 == "Calabria" ~ "South Italy",
          NAME_1 == "Basilicata" ~ "South Italy",
          NAME_1 == "Sardegna" ~ "Sicily-Sardegna",
          NAME_1 == "Sicily" ~ "Sicily-Sardegna",
          T ~ NAME_1
        )
      ) %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_GBR_1_sp.rds") %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_GRC_1_sp.rds") %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_DNK_2_sp.rds") %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_NLD_1_sp.rds") %>% 
      mutate(
        NAME_1 = case_when(
          NAME_1 == "Drenthe" ~ "Nord Netherlands",
          NAME_1 == "Flevoland" ~ "Nord Netherlands",
          NAME_1 == "Friesland" ~ "Nord Netherlands",
          NAME_1 == "Groningen" ~ "Nord Netherlands",
          NAME_1 == "IJsselmeer" ~ "Nord Netherlands",
          NAME_1 == "Zeeland" ~ "Zuid-Holland",
          NAME_1 == "Zeeuwse meren" ~ "Nord Netherlands",
          T ~ NAME_1
        )
      ) %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_TUR_1_sp.rds") %>% 
      mutate(
        NAME_1 = case_when(
          NAME_1 == "Adana" ~ "Mediterranean",
          NAME_1 == "Adiyaman" ~ "East",
          NAME_1 == "Afyon" ~ "Aegean",
          NAME_1 == "Agri" ~ "Anatolia",
          NAME_1 == "Aksaray" ~ "Anatolia",
          NAME_1 == "Amasya" ~ "Black Sea",
          NAME_1 == "Ankara" ~ "Anatolia",
          NAME_1 == "Antalya" ~ "Mediterranean",
          NAME_1 == "Ardahan" ~ "Black Sea",
          NAME_1 == "Artvin" ~ "Black Sea",
          NAME_1 == "Aydin" ~ "Aegean",
          NAME_1 == "Balikesir" ~ "Marmara",
          NAME_1 == "Bartın" ~ "Black Sea",
          NAME_1 == "Batman" ~ "East",
          NAME_1 == "Bayburt" ~ "Anatolia",
          NAME_1 == "Bilecik" ~ "Marmara",
          NAME_1 == "Bingöl" ~ "Anatolia",
          NAME_1 == "Bitlis" ~ "East",
          NAME_1 == "Bolu" ~ "Marmara",
          NAME_1 == "Burdur" ~ "Mediterranean",
          NAME_1 == "Bursa" ~ "Marmara",
          NAME_1 == "Çanakkale" ~ "Marmara",
          NAME_1 == "Çankiri" ~ "Anatolia",
          NAME_1 == "Çorum" ~ "Black Sea",
          NAME_1 == "Denizli" ~ "Aegean",
          NAME_1 == "Diyarbakir" ~ "East",
          NAME_1 == "Düzce" ~ "Black Sea",
          NAME_1 == "Edirne" ~ "Marmara",
          NAME_1 == "Elazığ" ~ "Anatolia",
          NAME_1 == "Erzincan" ~ "Anatolia",
          NAME_1 == "Erzurum" ~ "Anatolia",
          NAME_1 == "Eskisehir" ~ "Anatolia",
          NAME_1 == "Gaziantep" ~ "East",
          NAME_1 == "Giresun" ~ "Black Sea",
          NAME_1 == "Gümüshane" ~ "Black Sea",
          NAME_1 == "Hakkari" ~ "East",
          NAME_1 == "Hatay" ~ "Mediterranean",
          NAME_1 == "Iğdır" ~ "East",
          NAME_1 == "Isparta" ~ "Mediterranean",
          NAME_1 == "Istanbul" ~ "Istanbul",
          NAME_1 == "Izmir" ~ "Aegean",
          NAME_1 == "K. Maras" ~ "Mediterranean",
          NAME_1 == "Karabük" ~ "Black Sea",
          NAME_1 == "Karaman" ~ "Anatolia",
          NAME_1 == "Kars" ~ "East",
          NAME_1 == "Kastamonu" ~ "Black Sea",
          NAME_1 == "Kayseri" ~ "Anatolia",
          NAME_1 == "Kilis" ~ "East",
          NAME_1 == "Kinkkale" ~ "Anatolia",
          NAME_1 == "Kirklareli" ~ "Marmara",
          NAME_1 == "Kirsehir" ~ "Anatolia",
          NAME_1 == "Kocaeli" ~ "Marmara",
          NAME_1 == "Konya" ~ "Anatolia",
          NAME_1 == "Kütahya" ~ "Aegean",
          NAME_1 == "Malatya" ~ "Anatolia",
          NAME_1 == "Manisa" ~ "Aegean",
          NAME_1 == "Mardin" ~ "East",
          NAME_1 == "Mersin" ~ "Mediterranean",
          NAME_1 == "Mugla" ~ "Mediterranean",
          NAME_1 == "Mus" ~ "Anatolia",
          NAME_1 == "Nevsehir" ~ "Anatolia",
          NAME_1 == "Nigde" ~ "Anatolia",
          NAME_1 == "Ordu" ~ "Black Sea",
          NAME_1 == "Osmaniye" ~ "Mediterranean",
          NAME_1 == "Rize" ~ "Black Sea",
          NAME_1 == "Sakarya" ~ "Black Sea",
          NAME_1 == "Samsun" ~ "Black Sea",
          NAME_1 == "Sanliurfa" ~ "East",
          NAME_1 == "Siirt" ~ "East",
          NAME_1 == "Sinop" ~ "Black Sea",
          NAME_1 == "Sirnak" ~ "East",
          NAME_1 == "Sivas" ~ "Anatolia",
          NAME_1 == "Tekirdag" ~ "Marmara",
          NAME_1 == "Tokat" ~ "Black Sea",
          NAME_1 == "Trabzon" ~ "Black Sea",
          NAME_1 == "Tunceli" ~ "Anatolia",
          NAME_1 == "Usak" ~ "Aegean",
          NAME_1 == "Van" ~ "Anatolia",
          NAME_1 == "Yalova" ~ "Marmara",
          NAME_1 == "Yozgat" ~ "Anatolia",
          NAME_1 == "Zinguldak" ~ "Black Sea"
        )) %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_POL_1_sp.rds") %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_DEU_1_sp.rds") %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_UKR_1_sp.rds") %>% 
      mutate(
        NAME_1 = case_when(
          NAME_1 == "Crimea" ~ "South Ukraine",
          NAME_1 == "Sevastopol'" ~ "South Ukraine",
          NAME_1 == "Ivano-Frankivs'k" ~ "West Ukraine",
          NAME_1 == "Rivne" ~ "West Ukraine",
          NAME_1 == "Poltava" ~ "Center Ukraine",
          NAME_1 == "Sumy" ~ "Nord Ukraine",
          NAME_1 == "Chernihiv" ~ "Nord Ukraine",
          NAME_1 == "Chernivtsi" ~ "West Ukraine",
          NAME_1 == "Kharkiv" ~ "East Ukraine",
          NAME_1 == "Zhytomyr" ~ "Nord Ukraine",
          NAME_1 == "Kirovohrad" ~ "Center Ukraine",
          NAME_1 == "Cherkasy" ~ "Center Ukraine",
          NAME_1 == "Volyn" ~ "West Ukraine",
          NAME_1 == "Mykolayiv" ~ "South Ukraine",
          NAME_1 == "Kherson" ~ "South Ukraine",
          NAME_1 == "Zaporizhzhya" ~ "South Ukraine",
          NAME_1 == "Dnipropetrovs'k" ~ "Center Ukraine",
          NAME_1 == "L'viv" ~ "West Ukraine",
          NAME_1 == "Luhans'k" ~ "East Ukraine",
          NAME_1 == "Donets'k" ~ "East Ukraine",
          NAME_1 == "Transcarpathia" ~ "West Ukraine",
          NAME_1 == "Khmel'nyts'kyy" ~ "West Ukraine",
          NAME_1 == "Kiev" ~ "Nord Ukraine",
          NAME_1 == "Kiev City" ~ "Nord Ukraine",
          NAME_1 == "Odessa" ~ "South Ukraine",
          NAME_1 == "Vinnytsya" ~ "Center Ukraine",
          NAME_1 == "Ternopil'" ~ "West Ukraine"
        )
      ) %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_ESP_1_sp.rds") %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_ALB_1_sp.rds") %>% 
      mutate(
        NAME_1 = case_when(
          NAME_1 == "Shkodër" ~ "Nord Albania",
          NAME_1 == "Kukës" ~ "Nord Albania",
          NAME_1 == "Lezhë" ~ "Nord Albania",
          NAME_1 == "Dibër" ~ "Nord Albania",
          NAME_1 == "Durrës" ~ "Nord Albania",
          NAME_1 == "Tiranë" ~ "Nord Albania",
          T ~ "South Albania"
        )
      ) %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_AUT_1_sp.rds") %>% unite(), 
    readr::read_rds("~/social_data_analysis/data/gadm36_FIN_1_sp.rds") %>% unite()
  ),
  regions_gSimplify = rmapshaper::ms_simplify(reg, keep = 0.005, keep_shapes = T),
  tendenz = map_dfr(unique(ess$round_year), 
                    function(x) {
                      cnt <- ess %>% 
                        filter(round_year == x) %>% 
                        dplyr::select(region, cntry) %>% 
                        distinct(.keep_all = T)
                      
                      tbl <- ess %>% 
                        filter(round_year == x) %>% 
                        filter(region %in% cnt$region[cnt$region %in% reg$id]) %>% 
                        group_by(region) %>% summarise(
                          `Openness to Change` = median(`Openness to Change`, na.rm = T),
                          Conservation = median(Conservation, na.rm = T),
                          `Self-Enhancement` = median(`Self-Enhancement`, na.rm = T),
                          `Self-Trancendence` = median(`Self-Trancendence`, na.rm=T)
                        )
                      
                      regions_gSimplify@data <- regions_gSimplify@data %>% left_join(tbl, by = c("id" = "region"))
                      regions_gSimplify <- regions_gSimplify[(is.na(regions_gSimplify@data) %>% apply(1, sum))==0,]
                      
                      return(imoran(regions_gSimplify))
                    }, .id = "round"),
  tendenz_lines = ggplot(tendenz, aes(as.numeric(round), estimate1, linetype = value)) + 
    xlab("Хвиля ЄСС") +
    ylab("Значення Морана І") +
    scale_linetype_discrete(name = "Цінності") +
    geom_path() + 
    theme_minimal() + 
    theme(legend.position="top"),
  ages = map2_dfr(c(12,35,61), c(34, 60, 150), 
                  function(x, y) {
                    cnt <- ess %>% 
                      dplyr::select(region, cntry) %>% 
                      distinct(.keep_all = T)
                    
                    tbl <- ess %>% 
                      filter(between(agea, x, y)) %>% 
                      filter(region %in% cnt$region[cnt$region %in% reg$id]) %>% 
                      group_by(region) %>% summarise(
                        `Openness to Change` = median(`Openness to Change`, na.rm = T),
                        Conservation = median(Conservation, na.rm = T),
                        `Self-Enhancement` = median(`Self-Enhancement`, na.rm = T),
                        `Self-Trancendence` = median(`Self-Trancendence`, na.rm=T)
                      )
                    
                    regions_gSimplify@data <- regions_gSimplify@data %>% left_join(tbl, by = c("id" = "region"))
                    regions_gSimplify <- regions_gSimplify[(is.na(regions_gSimplify@data) %>% apply(1, sum))==0,]
                    
                    return(imoran(regions_gSimplify))
                  }, .id = "Вікова група") %>% 
    dplyr::select(`Вікова група`, value, estimate1) %>% 
    tidyr::spread("value", "estimate1") %>% mutate(
      `Вікова група` = c("Молодь (до 35 років)", "Середній вік (35-60 років)", "Старший вік (60+ років)")
    ),
  country_groups = map_dfr(list(es2002, es2004, es2007, es2013, all_year), 
                           function(x) {
                             cnt <- ess %>% 
                               dplyr::select(region, cntry) %>% 
                               distinct(.keep_all = T)
                             
                             tbl <- ess %>% 
                               filter(cntry %in% x) %>% 
                               filter(region %in% cnt$region[cnt$region %in% reg$id]) %>% 
                               group_by(region) %>% summarise(
                                 `Openness to Change` = median(`Openness to Change`, na.rm = T),
                                 Conservation = median(Conservation, na.rm = T),
                                 `Self-Enhancement` = median(`Self-Enhancement`, na.rm = T),
                                 `Self-Trancendence` = median(`Self-Trancendence`, na.rm=T)
                               )
                             
                             regions_gSimplify@data <- regions_gSimplify@data %>% left_join(tbl, by = c("id" = "region"))
                             regions_gSimplify <- regions_gSimplify[(is.na(regions_gSimplify@data) %>% apply(1, sum))==0,]
                             
                             return(imoran(regions_gSimplify))
                           }, .id = "Група країн") %>% 
    dplyr::select(`Група країн`, value, estimate1) %>% 
    tidyr::spread("value", "estimate1") %>% mutate(
      `Група країн` = c("Члени ЄС станом на 2002 рік", 
                        "Члени ЄС станом на 2004 рік",
                        "Члени ЄС станом на 2007 рік",
                        "Члени ЄС станом на 2013 рік",
                        "Всі країни-учасники ЄСС"
      )
    ),
  tendenz_all = map_dfr(unique(ess$round_year), 
                        function(x) {
                          cnt <- ess %>% 
                            filter(round_year == x) %>% 
                            dplyr::select(region, cntry) %>% 
                            distinct(.keep_all = T)
                          
                          tbl <- ess %>% 
                            filter(round_year == x) %>% 
                            filter(cntry %in% all_year) %>% 
                            filter(region %in% cnt$region[cnt$region %in% reg$id]) %>% 
                            group_by(region) %>% summarise(
                              `Openness to Change` = median(`Openness to Change`, na.rm = T),
                              Conservation = median(Conservation, na.rm = T),
                              `Self-Enhancement` = median(`Self-Enhancement`, na.rm = T),
                              `Self-Trancendence` = median(`Self-Trancendence`, na.rm=T)
                            )
                          
                          regions_gSimplify@data <- regions_gSimplify@data %>% left_join(tbl, by = c("id" = "region"))
                          regions_gSimplify <- regions_gSimplify[(is.na(regions_gSimplify@data) %>% apply(1, sum))==0,]
                          
                          return(imoran(regions_gSimplify))
                        }, .id = "Хвиля"),
  tendenz_all_line = ggplot(tendenz_all, aes(as.numeric(Хвиля), estimate1, linetype = value)) + 
    xlab("Хвиля ЄСС") +
    ylab("Значення Морана І") +
    scale_linetype_discrete(name = "Цінності") +
    geom_path() + 
    theme_minimal() + 
    theme(legend.position="top"),
  tendenz_all_table = tendenz_all %>% 
    dplyr::select(Хвиля, value, estimate1) %>% 
    tidyr::spread("value", "estimate1"),
  tendenz_all_smooth = ggplot(tendenz_all, aes(as.numeric(Хвиля), estimate1, linetype = value)) + 
    xlab("Хвиля ЄСС") +
    ylab("Значення Морана І") +
    scale_linetype_discrete(name = "Цінності") +
    geom_smooth(se = F, method = "lm") + 
    theme_minimal() + 
    theme(legend.position="top"),
  cnt = ess %>% dplyr::select(region, cntry) %>% distinct(.keep_all = T),
  tbl = ess %>% 
    filter(region %in% cnt$region[cnt$region %in% reg$id]) %>% 
    group_by(region) %>% 
    top_n(1, round_year) %>% 
    summarise(
      `Openness to Change` = median(`Openness to Change`, na.rm = T),
      Conservation = median(Conservation, na.rm = T),
      `Self-Enhancement` = median(`Self-Enhancement`, na.rm = T),
      `Self-Trancendence` = median(`Self-Trancendence`, na.rm=T),
      security = median(security, na.rm = T),
      conformity = median(conformity, na.rm = T),
      tradition = median(tradition, na.rm = T),
      benevolence = median(benevolence, na.rm = T),
      universalism = median(universalism, na.rm = T),
      self_direction = median(self_direction, na.rm = T),
      stimulation = median(stimulation, na.rm = T),
      hedonism = median(hedonism, na.rm = T),
      achievement = median(achievement, na.rm = T),
      power = median(power, na.rm = T)
    ) %>% norm_tbl(),
  regions_gSimplify_df = fortify(regions_gSimplify, region = "id")  %>% 
    left_join(
      left_join(
        reg[reg$id %in% cnt$region,]@data %>% 
          mutate(id = as.character(id)), tbl, by = c("id" = "region")
      ), by = "id"),
  values_distribution_plot = ggpubr::ggarrange(
    (ggplot() +
       geom_map(data = regions_gSimplify_df, map = regions_gSimplify_df, 
                aes(long, lat, map_id = id, fill = `Openness to Change`)) + theme_void() + 
       scale_fill_gradient(low = "white", high = "black", name = "Відкритість до змін") +
       coord_map("gilbert", xlim = c(-10, 50), ylim = c(33, 71)) + theme(legend.position="top")),
    (ggplot() +
       geom_map(data = regions_gSimplify_df, map = regions_gSimplify_df, 
                aes(long, lat, map_id = id, fill = `Self-Trancendence`)) + theme_void() + 
       scale_fill_gradient(low = "white", high = "black" , name = "Самоперевершення") +
       coord_map("gilbert", xlim = c(-10, 50), ylim = c(33, 71)) + theme(legend.position="top")),
    (ggplot() +
       geom_map(data = regions_gSimplify_df, map = regions_gSimplify_df, 
                aes(long, lat, map_id = id, fill = Conservation)) + theme_void() + 
       scale_fill_gradient(low = "white", high = "black" , name = "Збереження") +
       coord_map("gilbert", xlim = c(-10, 50), ylim = c(33, 71)) + theme(legend.position="top")),
    (ggplot() +
       geom_map(data = regions_gSimplify_df, map = regions_gSimplify_df, 
                aes(long, lat, map_id = id, fill = `Self-Enhancement`)) + theme_void() + 
       scale_fill_gradient(low = "white", high = "black" , name = "Самовдосконалення") +
       coord_map("gilbert", xlim = c(-10, 50), ylim = c(33, 71)) + theme(legend.position="top")),ncol = 2, nrow = 2
  ),
  regions_gSimplify_wide = regions_gSimplify_df %>% 
    select(long, lat, order, hole, piece, id, group, security, 
           conformity, tradition, benevolence, universalism, 
           self_direction, stimulation, hedonism, achievement, power) %>% 
    tidyr::gather(key = value, value = score, security, conformity, 
                  tradition, benevolence, universalism, self_direction, 
                  stimulation, hedonism, achievement, power),
  values_choropleth = ggplot(regions_gSimplify_wide, aes(map_id = id)) +
    geom_map(map = regions_gSimplify_wide, 
             aes(fill = score)) + 
    expand_limits(x = regions_gSimplify_wide$long, 
                  y = regions_gSimplify_wide$lat) +
    scale_fill_gradient(low = "#fff5eb", high = "#7f2704") +
    theme_void() + 
    coord_map("ortho", orientation = c(41, 22, -10), 
              xlim = c(-10, 43), ylim = c(33, 70)) + 
    theme(
      legend.position = "bottom", 
      strip.text = element_text(family = "PT Sans", size = 15, face = "bold"),
      legend.title = element_blank(), 
      legend.text = element_text(family = "PT Sans", size = 15),
      plot.margin = unit(c(0, 0, 0, 0),"cm")
    ) +
    guides(fill = guide_legend(title.position = "left", ncol = 6, 
                               keywidth = 2, keyheight = 2,
                               label.position = "bottom")) + 
    facet_wrap(~value, ncol = 2),
  D0 = tbl[6:15] %>% 
    as.matrix() %>% 
    dist(method = "minkowski"),
  idx = sapply(
    (tbl %>% select(region) %>% 
       left_join(
         regions_gSimplify@data %>% 
           mutate(id = as.character(id)), by = c("region" = "id")
       ) %>% 
       distinct() %>% pull(region)) %>% unique(), function(x) {
         which(x == as.character(regions_gSimplify$id %>% unique()))
       }
  ) %>% unlist() %>% unique(),
  A = spdep::nb2mat(
    spdep::poly2nb(
      regions_gSimplify
    ), style = "B", zero.policy = T) %>% 
    modify_A(idx, tbl),
  D1 = as.dist(1 - A),
  fit = ClustGeo::hclustgeo(D0, D1, alpha = 0.18),
  dendrogram = ggdendro::ggdendrogram(fit, rotate = TRUE, theme_dendro = FALSE) +
    ylab("") +
    xlab("") +
    geom_hline(yintercept = 0.01, linetype = "dashed") +
    geom_hline(yintercept = 0.005, linetype = "dashed") +
    theme_minimal() + theme(
      axis.text.y = element_text(family = "PT Sans", size = 5),
      panel.grid.minor = element_blank(),
      panel.grid.major.y = element_blank()
    ),
  tbl2 = tbl %>% mutate(
    two_cluster_solution = cutree(fit, h = 0.01),
    five_cluster_solution = cutree(fit, h = 0.005)
  ) %>% group_by(two_cluster_solution) %>% 
    mutate(
      five_cluster_solution = paste0(two_cluster_solution, ".", as.numeric(as.factor(five_cluster_solution)))
    ) %>% ungroup(),
  cluster_decision = ClustGeo::choicealpha(D0, D1, 
                                           range.alpha = seq(0, 0.5, by = 0.01),
                                           K = 33, graph = F)$Qnorm %>% 
    as_tibble(rownames = "alpha") %>% 
    rename(`D0 model` = "Q0norm",`D1 model` = "Q1norm") %>% 
    mutate(alpha = readr::parse_number(alpha)) %>% 
    tidyr::gather("clustering", "explained inertia", - alpha) %>% 
    ggplot(aes(alpha, `explained inertia`, color = clustering)) + 
    geom_path() +
    scale_color_manual(values = c("#a6cee3", "#b2df8a")) +
    theme_minimal() + theme(
      axis.text = element_text(family = "PT Sans", size = 9),
      panel.grid.minor = element_blank(),
      panel.grid.major = element_line(colour = "black", 
                                      linetype = "dashed", size = 0.05)
    ),
  regions_gSimplify_df2 = fortify(regions_gSimplify, region = "id")  %>% 
    left_join(
      left_join(
        reg[reg$id %in% cnt$region,]@data %>% 
          mutate(id = as.character(id)), tbl2, by = c("id" = "region")
      ), by = "id"),
  clusters_plot = ggplot() +
    geom_map(data = regions_gSimplify_df2 %>% filter(!is.na(five_cluster_solution)),
             map = regions_gSimplify_df2 %>% filter(!is.na(five_cluster_solution)), 
             aes(map_id = id, fill = five_cluster_solution)) + 
    expand_limits(x = regions_gSimplify_df2$long, y = regions_gSimplify_df2$lat) +
    theme_void() + 
    scale_fill_manual(values = unname(clusters_fill),
                      na.value = "lightgrey") +
    coord_map("gilbert", xlim = c(-10, 50), ylim = c(33, 71)) + 
    geom_text(aes(x=-20, y = 70, label = "European values clusters", 
                  hjust = 0, vjust=1), family = "PT Sans", color = "black", size = 5)+
    geom_text(aes(x=-20, y = 68.6, label = "    Based on ESS data", 
                  hjust = 0, vjust = 1), family = "PT Sans", color = "black", size = 3)+
    theme(
      legend.position = "bottom", 
      legend.title = element_text(family = "PT Sans", size = 14, face = "bold"), 
      legend.text = element_text(family = "PT Sans", size = 13)
    ) +
    guides(fill = guide_legend(title = "values cluster",
                               title.position = "left", ncol = 6, 
                               keywidth = 2, keyheight = 2,
                               label.position = "bottom")),
  ess_economy = readr::read_rds("data/ess_new.rds") %>% mutate(
    detrend_SE = lm(`Self-Enhancement` ~ birth_date, data = .) %>% resid,
    detrend_CO = lm(Conservation ~ birth_date, data = .) %>% resid,
    detrend_ST = lm(`Self-Trancendence` ~ birth_date, data = .) %>% resid,
    detrend_OC = lm(`Openness to Change` ~ birth_date, data = .) %>% resid,
    deterendPG = lm(gdp_temp ~ birth_date, data = .) %>% resid
  ),
  conservation = ess_economy %>% group_by(birth_date) %>% 
    summarise(Conservation = mean(Conservation, na.rm = T)) %>% pull(Conservation),
  acf_conservation = acf(conservation, lag.max = 80),
  growth = ess_economy %>% group_by(birth_date) %>% 
    summarise(percent_growth = mean(percent_growth, na.rm = T)) %>% pull(percent_growth),
  acf_growth = acf(growth, lag.max = 80),
  se_cor = ess_economy %>% 
    dplyr::select(cntry, detrend_SE, percent_growth) %>% 
    group_by(cntry) %>% do(
      ft = cor.test(~ detrend_SE + percent_growth, data = .) %>% broom::tidy()
    ),
  se_cor_df = se_cor$ft %>% bind_rows() %>% mutate(
    cntry = se_cor$cntry
  ) %>% dplyr::select(9,1:6) %>% 
    mutate_at(2:7, round, 2) %>% 
    arrange(desc(abs(estimate))),
  se_anova = ess_economy %>% 
    dplyr::select(cntry, detrend_SE, percent_growth) %>% 
    group_by(cntry) %>% do(
      ft = anova(lm(detrend_SE ~ percent_growth, data = .)) %>% broom::tidy() %>% dplyr::slice(1)
    ),
  se_anova_df = se_anova$ft %>% bind_rows() %>% mutate(
    cntry = se_anova$cntry
  ) %>% dplyr::select(7, 3:6) %>% 
    mutate_at(2:5, round, 2) %>% 
    arrange(p.value),
  co_cor = ess_economy %>% 
    dplyr::select(cntry, detrend_CO, percent_growth) %>% 
    group_by(cntry) %>% do(
      ft = cor.test(~ detrend_CO + percent_growth, data = .) %>% broom::tidy()
    ),
  co_cor_df = co_cor$ft %>% bind_rows() %>% mutate(
    cntry = co_cor$cntry
  ) %>% dplyr::select(9, 1:6) %>% 
    mutate_at(2:7, round, 2) %>% arrange(desc(abs(estimate))),
  co_anova = ess_economy %>% 
    dplyr::select(cntry, detrend_CO, percent_growth) %>% 
    group_by(cntry) %>% do(
      ft = anova(lm(detrend_CO ~ percent_growth, data = .)) %>% broom::tidy() %>% dplyr::slice(1)
    ),
  co_anova_df = co_anova$ft %>% bind_rows() %>% mutate(
    cntry = co_anova$cntry
  ) %>% dplyr::select(7,3:6) %>% mutate_at(2:5, round, 2) %>% arrange(`p.value`),
  #'
  #' Читаємо файл з політичними даними
  #'
  polits_df = readr::read_rds("~/social_data_analysis/data/polits.rds") %>% 
    filter(!is.na(Conservation)) %>% 
    mutate_all(
      ~ifelse(is.infinite(.) | is.nan(.) | is.na(.), 0, .)
    ) %>% select_if(
      ~((sd(.,na.rm = T) != 0) | (is.na(sd(.,na.rm = T))))
    ) %>% mutate(
      defmin_mean = ifelse(is.na(defmin_mean), 0, defmin_mean),
      defmin_max = ifelse(is.na(defmin_max), 0, defmin_max),
      defmin_sd = ifelse(is.na(defmin_sd), 0, defmin_sd),
      defmin_n_distinct = ifelse(is.na(defmin_n_distinct), 0, defmin_n_distinct),
    ) %>% polit_residual(),
  ps = skimr::skim(polits_df),
  #'
  #' Список назв змінних з розшифровкою
  #'
  variable_dictionary = tibble::enframe(unlist(map(haven::read_stata("~/social_data_analysis/data/Database DPI2017/DPI2017.dta"), ~attr(.,"label")))),
  #'
  #' Робимо аналіз середніх
  #'
  t_test_summary = map_dfr(colnames(polits_df)[30:ncol(polits_df)], function(x) t_all(var = x, polits_df = polits_df)),
  #' 
  #' Отримуємо таблиці важливості ознак на основі градієнтного бустингу
  #' 
  dt = data.matrix(polits_df[, 30:ncol(polits_df)]),
  imp_oc = lgb_train(dt, as.numeric(polits_df$`Openness to Change` > polits_df$Conservation), params),
  imp_st = lgb_train(data = dt, label = as.numeric(polits_df$`Self-Trancendence` > polits_df$`Self-Enhancement`), params),
  #'
  #' Візуалізація відкритості до змін і збереження
  #'
  viz_oc = polits_df %>% 
    mutate(open = ifelse(`Openness to Change` > Conservation, "Більша відкритість до змін", "Більша консервативність")) %>% 
    dplyr::select(open, imp_oc %>% 
             as_tibble() %>% 
             filter(Feature %in% (t_test_summary %>% filter(`p.value` == 0 & depend == "op_co") %>% pull(variable))) %>% 
             dplyr::slice(1:9) %>% pull(Feature)) %>% 
    tidyr::gather("name", "value", -open) %>% 
    group_by(name) %>% 
    mutate(value = ntile(value, 30)) %>% 
    ungroup() %>% 
    mutate(name = as.numeric(as.factor(name))) %>% 
    #mutate(name = paste0(name %>% stringr::str_split("_") %>% sapply(function(.).[[1]]), " (",
    #                     name %>% stringr::str_split("_") %>% sapply(function(.).[[length(.)]]),")")) %>% 
    ggplot(aes(value, group = open, fill = open, color = NULL)) +
    scale_fill_manual(values = c("#e41a1c", "#4daf4a")) +
    geom_density(alpha = 0.8, position = "fill") +
    ggtitle(label = "Основні фактори впливу на пару відкритість до змін-збереження") +
    theme_ipsum() +
    facet_wrap(~name, scales = "free") +
    xlab("") +
    theme(legend.position = "bottom", legend.title = element_blank()),
  #'
  #' Візуалізація самоперевершення і саморозвитку
  #'
  viz_st = polits_df %>% 
    mutate(open = ifelse(`Self-Trancendence` > `Self-Enhancement`, "Більше самоперевершення", "Більший саморозвиток")) %>% 
    dplyr::select(open, imp_st %>% 
             as_tibble() %>% 
             filter(Feature %in% (t_test_summary %>% filter(`p.value` == 0 & depend == "st_se") %>% pull(variable))) %>% 
             dplyr::slice(1:9) %>% pull(Feature)) %>% 
    tidyr::gather("name", "value", -open) %>% 
    group_by(name) %>% 
    mutate(value = ntile(value, 30)) %>% 
    ungroup() %>% 
    mutate(name = as.numeric(as.factor(name))) %>% 
    #mutate(name = paste0(name %>% stringr::str_split("_") %>% sapply(function(.).[[1]]), " (",
    #                     name %>% stringr::str_split("_") %>% sapply(function(.).[[length(.)]]),")")) %>% 
    ggplot(aes(value, group = open, fill = open, color = NULL)) +
    scale_fill_manual(values = c("#e41a1c", "#4daf4a")) +
    geom_density(alpha = 0.8, position = "fill") +
    ggtitle(label = "Основні фактори впливу на пару самоперевершення-саморозвиток") +
    theme_ipsum(base_family = "PT Sans") +
    facet_wrap(~name, scales = "free") +
    xlab("") +
    theme(legend.position = "bottom", legend.title = element_blank()),
  report = rmarkdown::render(
    knitr_in("masters_thesis.Rmd"),
    output_file = file_out("masters_thesis.docx"),
    quiet = TRUE
  )
)

config <- drake_config(plan)
vis_drake_graph(config)

#clean()

make(plan, jobs = 4, parallelism = "future")
```

